<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Foundations of Causal Thinking in Public Health | Causal-Inference-Graduate.knit</title>
  <meta name="description" content="An undergraduate course on causal inference" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Foundations of Causal Thinking in Public Health | Causal-Inference-Graduate.knit" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An undergraduate course on causal inference" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Foundations of Causal Thinking in Public Health | Causal-Inference-Graduate.knit" />
  
  <meta name="twitter:description" content="An undergraduate course on causal inference" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="setup.html"/>
<link rel="next" href="randomized-control-trials.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course Description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructor"><i class="fa fa-check"></i>Instructor</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#teaching-assistants"><i class="fa fa-check"></i>Teaching Assistants</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-logistics"><i class="fa fa-check"></i>Course Logistics</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#required-materials"><i class="fa fa-check"></i>Required Materials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#upon-successful-completion-of-this-course-students-will-be-able-to"><i class="fa fa-check"></i>Upon successful completion of this course, students will be able to:</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#tools"><i class="fa fa-check"></i>Tools</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#useful-links"><i class="fa fa-check"></i>Useful Links</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i>Setup</a>
<ul>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html#installing-and-using-required-packages"><i class="fa fa-check"></i>Installing and Using Required Packages</a></li>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html#loading-packages"><i class="fa fa-check"></i>Loading Packages</a></li>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html#difference-between-install.packages-and-library"><i class="fa fa-check"></i>Difference Between install.packages() and library()</a></li>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html#session-information"><i class="fa fa-check"></i>Session Information</a></li>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html#why-include-this"><i class="fa fa-check"></i>Why include this?</a></li>
<li class="chapter" data-level="" data-path="setup.html"><a href="setup.html#base-r-version-simple"><i class="fa fa-check"></i>Base R version (simple)</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="foundations-of-causal-thinking-in-public-health.html"><a href="foundations-of-causal-thinking-in-public-health.html"><i class="fa fa-check"></i><b>1</b> Foundations of Causal Thinking in Public Health</a>
<ul>
<li class="chapter" data-level="1.1" data-path="foundations-of-causal-thinking-in-public-health.html"><a href="foundations-of-causal-thinking-in-public-health.html#association-vs.-causation"><i class="fa fa-check"></i><b>1.1</b> Association vs. Causation</a></li>
<li class="chapter" data-level="1.2" data-path="foundations-of-causal-thinking-in-public-health.html"><a href="foundations-of-causal-thinking-in-public-health.html#introduction-to-counterfactuals-and-potential-outcomes"><i class="fa fa-check"></i><b>1.2</b> Introduction to Counterfactuals and Potential Outcomes</a></li>
<li class="chapter" data-level="1.3" data-path="foundations-of-causal-thinking-in-public-health.html"><a href="foundations-of-causal-thinking-in-public-health.html#causal-estimands-and-identification"><i class="fa fa-check"></i><b>1.3</b> Causal Estimands and Identification</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="randomized-control-trials.html"><a href="randomized-control-trials.html"><i class="fa fa-check"></i><b>2</b> Randomized Control Trials</a>
<ul>
<li class="chapter" data-level="2.1" data-path="randomized-control-trials.html"><a href="randomized-control-trials.html#randomized-controlled-trials-the-gold-standard"><i class="fa fa-check"></i><b>2.1</b> Randomized controlled trials: the gold standard</a></li>
<li class="chapter" data-level="2.2" data-path="randomized-control-trials.html"><a href="randomized-control-trials.html#basic-experimental-design-principles"><i class="fa fa-check"></i><b>2.2</b> Basic Experimental Design Principles</a></li>
<li class="chapter" data-level="2.3" data-path="randomized-control-trials.html"><a href="randomized-control-trials.html#limitations-of-rcts-in-public-health-contexts"><i class="fa fa-check"></i><b>2.3</b> Limitations of RCTs in Public Health Contexts</a></li>
<li class="chapter" data-level="2.4" data-path="randomized-control-trials.html"><a href="randomized-control-trials.html#common-threats-to-internal-and-external-validity"><i class="fa fa-check"></i><b>2.4</b> Common Threats to Internal and External Validity</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="observational-studies.html"><a href="observational-studies.html"><i class="fa fa-check"></i><b>3</b> Observational Studies</a>
<ul>
<li class="chapter" data-level="3.1" data-path="observational-studies.html"><a href="observational-studies.html#the-challenge-of-confounding-in-public-health-and-medical-research"><i class="fa fa-check"></i><b>3.1</b> The challenge of confounding in public health and medical research</a></li>
<li class="chapter" data-level="3.2" data-path="observational-studies.html"><a href="observational-studies.html#exchangeability-positivity-and-consistency"><i class="fa fa-check"></i><b>3.2</b> Exchangeability, positivity, and consistency</a></li>
<li class="chapter" data-level="3.3" data-path="observational-studies.html"><a href="observational-studies.html#effect-identification-in-observational-studies"><i class="fa fa-check"></i><b>3.3</b> Effect Identification in Observational Studies</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="randomized-controlled-trials-rcts-and-quasi-experiments.html"><a href="randomized-controlled-trials-rcts-and-quasi-experiments.html"><i class="fa fa-check"></i><b>4</b> Randomized Controlled Trials (RCTs) and Quasi-Experiments</a>
<ul>
<li class="chapter" data-level="4.1" data-path="randomized-controlled-trials-rcts-and-quasi-experiments.html"><a href="randomized-controlled-trials-rcts-and-quasi-experiments.html#effect-modification-and-adjustment-methods"><i class="fa fa-check"></i><b>4.1</b> Effect Modification and Adjustment Methods</a></li>
<li class="chapter" data-level="4.2" data-path="randomized-controlled-trials-rcts-and-quasi-experiments.html"><a href="randomized-controlled-trials-rcts-and-quasi-experiments.html#identifying-interaction"><i class="fa fa-check"></i><b>4.2</b> Identifying Interaction</a></li>
<li class="chapter" data-level="4.3" data-path="randomized-controlled-trials-rcts-and-quasi-experiments.html"><a href="randomized-controlled-trials-rcts-and-quasi-experiments.html#effect-modification-vs-interaction"><i class="fa fa-check"></i><b>4.3</b> Effect Modification vs Interaction</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-causal-diagrams.html"><a href="introduction-to-causal-diagrams.html"><i class="fa fa-check"></i><b>5</b> Introduction to Causal Diagrams</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-causal-diagrams.html"><a href="introduction-to-causal-diagrams.html#basic-principles-of-directed-acyclic-graphs-dags"><i class="fa fa-check"></i><b>5.1</b> Basic principles of directed acyclic graphs (DAGs)</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-causal-diagrams.html"><a href="introduction-to-causal-diagrams.html#common-causal-structures-in-public-health"><i class="fa fa-check"></i><b>5.2</b> Common Causal Structures in Public Health</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-causal-diagrams.html"><a href="introduction-to-causal-diagrams.html#using-dags-to-introduce-and-understand-selection-bias"><i class="fa fa-check"></i><b>5.3</b> Using DAGs to introduce and understand selection bias</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="effect-modification-and-interaction.html"><a href="effect-modification-and-interaction.html"><i class="fa fa-check"></i><b>6</b> Effect Modification and Interaction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="effect-modification-and-interaction.html"><a href="effect-modification-and-interaction.html#the-structure-of-confounding"><i class="fa fa-check"></i><b>6.1</b> The Structure of Confounding</a></li>
<li class="chapter" data-level="6.2" data-path="effect-modification-and-interaction.html"><a href="effect-modification-and-interaction.html#how-to-adjust-for-confounding"><i class="fa fa-check"></i><b>6.2</b> How to Adjust for Confounding</a></li>
<li class="chapter" data-level="6.3" data-path="effect-modification-and-interaction.html"><a href="effect-modification-and-interaction.html#the-form-of-selection-bias"><i class="fa fa-check"></i><b>6.3</b> The Form of Selection Bias</a></li>
<li class="chapter" data-level="6.4" data-path="effect-modification-and-interaction.html"><a href="effect-modification-and-interaction.html#how-to-adjust-for-selection-bias"><i class="fa fa-check"></i><b>6.4</b> How to Adjust for Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="measurement-missing-data-and-selection-bias.html"><a href="measurement-missing-data-and-selection-bias.html"><i class="fa fa-check"></i><b>7</b> Measurement, Missing Data, and Selection Bias</a>
<ul>
<li class="chapter" data-level="7.1" data-path="measurement-missing-data-and-selection-bias.html"><a href="measurement-missing-data-and-selection-bias.html#measurement-bias"><i class="fa fa-check"></i><b>7.1</b> Measurement Bias</a></li>
<li class="chapter" data-level="7.2" data-path="measurement-missing-data-and-selection-bias.html"><a href="measurement-missing-data-and-selection-bias.html#non-causal-diagrams"><i class="fa fa-check"></i><b>7.2</b> Non-Causal Diagrams</a></li>
<li class="chapter" data-level="7.3" data-path="measurement-missing-data-and-selection-bias.html"><a href="measurement-missing-data-and-selection-bias.html#publication-bias-and-p-hacking"><i class="fa fa-check"></i><b>7.3</b> Publication Bias and P-Hacking</a></li>
<li class="chapter" data-level="7.4" data-path="measurement-missing-data-and-selection-bias.html"><a href="measurement-missing-data-and-selection-bias.html#over--and-mis-interpretation-of-statistical-analyses"><i class="fa fa-check"></i><b>7.4</b> Over- and Mis-Interpretation of Statistical Analyses</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="from-identification-to-estimation.html"><a href="from-identification-to-estimation.html"><i class="fa fa-check"></i><b>8</b> From Identification to Estimation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="from-identification-to-estimation.html"><a href="from-identification-to-estimation.html#identification-and-estimation"><i class="fa fa-check"></i><b>8.1</b> Identification and Estimation</a></li>
<li class="chapter" data-level="8.2" data-path="from-identification-to-estimation.html"><a href="from-identification-to-estimation.html#estimation-of-causal-effects"><i class="fa fa-check"></i><b>8.2</b> Estimation of causal effects</a></li>
<li class="chapter" data-level="8.3" data-path="from-identification-to-estimation.html"><a href="from-identification-to-estimation.html#taxonomy-of-estimation-models"><i class="fa fa-check"></i><b>8.3</b> Taxonomy of estimation models</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="applications-of-causal-inference-in-public-health-and-medical-research.html"><a href="applications-of-causal-inference-in-public-health-and-medical-research.html"><i class="fa fa-check"></i><b>9</b> Applications of Causal Inference in Public Health and Medical Research</a>
<ul>
<li class="chapter" data-level="9.1" data-path="applications-of-causal-inference-in-public-health-and-medical-research.html"><a href="applications-of-causal-inference-in-public-health-and-medical-research.html#public-health-policy-evaluation"><i class="fa fa-check"></i><b>9.1</b> Public health policy evaluation</a></li>
<li class="chapter" data-level="9.2" data-path="applications-of-causal-inference-in-public-health-and-medical-research.html"><a href="applications-of-causal-inference-in-public-health-and-medical-research.html#environmental-exposure-studies"><i class="fa fa-check"></i><b>9.2</b> Environmental exposure studies</a></li>
<li class="chapter" data-level="9.3" data-path="applications-of-causal-inference-in-public-health-and-medical-research.html"><a href="applications-of-causal-inference-in-public-health-and-medical-research.html#health-disparities-research"><i class="fa fa-check"></i><b>9.3</b> Health disparities research</a></li>
<li class="chapter" data-level="9.4" data-path="applications-of-causal-inference-in-public-health-and-medical-research.html"><a href="applications-of-causal-inference-in-public-health-and-medical-research.html#prevention-program-evaluation"><i class="fa fa-check"></i><b>9.4</b> Prevention program evaluation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="final-project-presentations.html"><a href="final-project-presentations.html"><i class="fa fa-check"></i><b>10</b> Final Project Presentations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="final-project-presentations.html"><a href="final-project-presentations.html#final-project"><i class="fa fa-check"></i><b>10.1</b> Final Project</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.falcobargaglistoffi.com/" target="blank">Instructor: Falco J. Bargagli-Stoffi</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="foundations-of-causal-thinking-in-public-health" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Foundations of Causal Thinking in Public Health<a href="foundations-of-causal-thinking-in-public-health.html#foundations-of-causal-thinking-in-public-health" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<h2 id="class-materials" class="hasAnchor">Class materials<a href="foundations-of-causal-thinking-in-public-health.html#class-materials" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Slides: <a href="https://drive.google.com/file/d/1ujOsEenrQy1sjIX4Zt_CfAqeF0o-KfY-/view?usp=sharing"><strong>Module 1</strong></a></p>
<p>Recording: <a href="https://drive.google.com/file/d/14yxdT8so1w2LQV2pwoGm1ys3Ek5yuLET/view?usp=sharing"><strong>Module 1, Part 1.1</strong></a></p>
<p>Recording: <a href="https://drive.google.com/file/d/1rUQnbOTkVk5DPu8Ghbu2W80NJ008Auyt/view?usp=sharing"><strong>Module 1, Part 2.1</strong></a></p>
<p>Recording: <a href="https://drive.google.com/file/d/1hsA1CZ0jpVycsNmuH0A7C5AHmlvBpOvM/view?usp=sharing"><strong>Module 1, Part 2.2</strong></a></p>
</blockquote>
<blockquote>
<h2 id="textbook-reading" class="hasAnchor">Textbook reading<a href="foundations-of-causal-thinking-in-public-health.html#textbook-reading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://static1.squarespace.com/static/675db8b0dd37046447128f5f/t/677676888e31cc50c2c33877/1735816881944/hernanrobins_WhatIf_2jan25.pdf"><strong>Hernán &amp; Robins, Causal Inference: What If – Chapters 1–2</strong></a></p>
</blockquote>
<blockquote>
<h2 id="supplementary-reading" class="hasAnchor">Supplementary reading<a href="foundations-of-causal-thinking-in-public-health.html#supplementary-reading" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://bayes.cs.ucla.edu/WHY/why-ch1.pdf"><strong>Pearl, J. and Mackenzie, D. (2018) The Book of Why: The New Science of Cause and Effect. Basic Books.</strong></a> Selected public health news articles (provided on the course site).</p>
</blockquote>
<blockquote>
<h2 id="topics-covered" class="hasAnchor">Topics covered<a href="foundations-of-causal-thinking-in-public-health.html#topics-covered" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Association vs. Causation<br />
</li>
<li>Introduction to Counterfactuals and Potential Outcomes<br />
</li>
<li>Causal Estimands and Identification<br />
</li>
<li>Critical reading exercise: analyzing causal claims in public health news</li>
</ul>
</blockquote>
<div id="association-vs.-causation" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Association vs. Causation<a href="foundations-of-causal-thinking-in-public-health.html#association-vs.-causation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Association</strong> refers to a statistical relationship where two variables move together, but one doesn’t necessarily cause the other. For instance, ice cream sales and drowning incidents both rise in the summer, not because one causes the other, but because they share a third factor: temperature. In contrast, <strong>causation</strong> implies a direct cause-and-effect relationship, where changing one variable leads to changes in another. Establishing causation requires rigorous methods, such as randomized controlled trials, to rule out confounding factors.</p>
<p><strong>Simpson’s Paradox</strong> occurs when a trend appears in separate groups but reverses when the data are combined. This paradox is driven by <strong>confounding variables</strong>—unaccounted factors that influence both the treatment and the outcome. It illustrates how aggregated data can be misleading and emphasizes the importance of analyzing relationships within subgroups to avoid drawing incorrect conclusions.</p>
<p>To demonstrate this paradox, I simulated a study comparing two pneumonia treatments across 2,000 people Treatment A was mostly given to mild cases, while Treatment B was given to severe cases. When data were analyzed without considering severity, Treatment A seemed more effective. However, when stratified by severity, Treatment B consistently showed lower death rates in both mild and severe groups. This was visualized through two plots: one showing the misleading overall trend, and another stratified by severity revealing the true relationship.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-1" tabindex="-1"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb5-2"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-2" tabindex="-1"></a><span class="co"># library(dplyr)</span></span>
<span id="cb5-3"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-5"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2050</span></span>
<span id="cb5-7"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-8" tabindex="-1"></a>severity <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Mild&quot;</span>, <span class="st">&quot;Severe&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1450</span>, <span class="dv">600</span>))</span>
<span id="cb5-9"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-10" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Treatment A&quot;</span>, <span class="dv">1400</span>), <span class="fu">rep</span>(<span class="st">&quot;Treatment B&quot;</span>, <span class="dv">50</span>), </span>
<span id="cb5-11"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-11" tabindex="-1"></a>               <span class="fu">rep</span>(<span class="st">&quot;Treatment A&quot;</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="st">&quot;Treatment B&quot;</span>, <span class="dv">500</span>)) </span>
<span id="cb5-12"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-13" tabindex="-1"></a>outcome <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rbinom</span>(<span class="dv">1400</span>, <span class="dv">1</span>, <span class="fl">0.15</span>),  <span class="co"># Mild + A (15% death rate)</span></span>
<span id="cb5-14"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-14" tabindex="-1"></a>             <span class="fu">rbinom</span>(<span class="dv">50</span>, <span class="dv">1</span>, <span class="fl">0.10</span>),    <span class="co"># Mild + B (10% death rate)</span></span>
<span id="cb5-15"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-15" tabindex="-1"></a>             <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">0.30</span>),   <span class="co"># Severe + A (30% death rate)</span></span>
<span id="cb5-16"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-16" tabindex="-1"></a>             <span class="fu">rbinom</span>(<span class="dv">500</span>, <span class="dv">1</span>, <span class="fl">0.20</span>))   <span class="co"># Severe + B (20% death rate)</span></span>
<span id="cb5-17"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-18" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-19"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-19" tabindex="-1"></a>  <span class="at">Severity =</span> severity,</span>
<span id="cb5-20"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-20" tabindex="-1"></a>  <span class="at">Treatment =</span> treatment,</span>
<span id="cb5-21"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-21" tabindex="-1"></a>  <span class="at">Outcome =</span> outcome</span>
<span id="cb5-22"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-22" tabindex="-1"></a>)</span>
<span id="cb5-23"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-23" tabindex="-1"></a></span>
<span id="cb5-24"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-24" tabindex="-1"></a>death_counts <span class="ot">&lt;-</span> <span class="fu">tapply</span>(df<span class="sc">$</span>Outcome, <span class="fu">list</span>(df<span class="sc">$</span>Severity, df<span class="sc">$</span>Treatment), sum)</span>
<span id="cb5-25"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-25" tabindex="-1"></a>table_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>Severity, df<span class="sc">$</span>Treatment)</span>
<span id="cb5-26"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-26" tabindex="-1"></a>death_rates <span class="ot">&lt;-</span> <span class="fu">round</span>(death_counts <span class="sc">/</span> table_counts, <span class="dv">3</span>)</span>
<span id="cb5-27"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-27" tabindex="-1"></a></span>
<span id="cb5-28"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-28" tabindex="-1"></a>overall_a <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Outcome[df<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">&quot;Treatment A&quot;</span>]) <span class="sc">/</span> <span class="fu">sum</span>(df<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">&quot;Treatment A&quot;</span>)</span>
<span id="cb5-29"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-29" tabindex="-1"></a>overall_b <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>Outcome[df<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">&quot;Treatment B&quot;</span>]) <span class="sc">/</span> <span class="fu">sum</span>(df<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">&quot;Treatment B&quot;</span>)</span>
<span id="cb5-30"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-30" tabindex="-1"></a></span>
<span id="cb5-31"><a href="foundations-of-causal-thinking-in-public-health.html#cb5-31" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Death rates by severity and treatment:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Death rates by severity and treatment:&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="foundations-of-causal-thinking-in-public-health.html#cb7-1" tabindex="-1"></a><span class="fu">print</span>(death_rates)</span></code></pre></div>
<pre><code>##        Treatment A Treatment B
## Mild         0.136       0.120
## Severe       0.380       0.204</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="foundations-of-causal-thinking-in-public-health.html#cb9-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall death rate (Treatment A):&quot;</span>, <span class="fu">round</span>(overall_a, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Overall death rate (Treatment A): 0.153</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="foundations-of-causal-thinking-in-public-health.html#cb11-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Overall death rate (Treatment B):&quot;</span>, <span class="fu">round</span>(overall_b, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Overall death rate (Treatment B): 0.196</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-1" tabindex="-1"></a>overall_plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-2"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-2" tabindex="-1"></a>  <span class="at">X_Pos =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb13-3"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-3" tabindex="-1"></a>  <span class="at">Death_rate =</span> <span class="fu">c</span>(overall_a, overall_b),</span>
<span id="cb13-4"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-4" tabindex="-1"></a>  <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="st">&quot;Treatment A&quot;</span>, <span class="st">&quot;Treatment B&quot;</span>)</span>
<span id="cb13-5"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-5" tabindex="-1"></a>)</span>
<span id="cb13-6"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-7" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(overall_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> X_Pos, <span class="at">y =</span> Death_rate, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb13-8"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb13-9"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Treatment A&quot;</span>, <span class="st">&quot;Treatment B&quot;</span>)) <span class="sc">+</span></span>
<span id="cb13-11"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-11" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Treatment A&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Treatment B&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb13-12"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Overall Trend (Simpson&#39;s Paradox)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Risk of Death&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-14"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-14" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb13-15"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="foundations-of-causal-thinking-in-public-health.html#cb13-16" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code></pre></div>
<p><img src="Causal-Inference-Graduate_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-1" tabindex="-1"></a>group_means <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Severity, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Death_rate =</span> <span class="fu">mean</span>(Outcome), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X_Pos =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-5"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-5" tabindex="-1"></a>    Severity <span class="sc">==</span> <span class="st">&quot;Mild&quot;</span> <span class="sc">&amp;</span> Treatment <span class="sc">==</span> <span class="st">&quot;Treatment A&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb14-6"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-6" tabindex="-1"></a>    Severity <span class="sc">==</span> <span class="st">&quot;Mild&quot;</span> <span class="sc">&amp;</span> Treatment <span class="sc">==</span> <span class="st">&quot;Treatment B&quot;</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb14-7"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-7" tabindex="-1"></a>    Severity <span class="sc">==</span> <span class="st">&quot;Severe&quot;</span> <span class="sc">&amp;</span> Treatment <span class="sc">==</span> <span class="st">&quot;Treatment A&quot;</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb14-8"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-8" tabindex="-1"></a>    Severity <span class="sc">==</span> <span class="st">&quot;Severe&quot;</span> <span class="sc">&amp;</span> Treatment <span class="sc">==</span> <span class="st">&quot;Treatment B&quot;</span> <span class="sc">~</span> <span class="dv">4</span></span>
<span id="cb14-9"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-9" tabindex="-1"></a>  ),</span>
<span id="cb14-10"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-10" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">paste</span>(Severity, <span class="st">&quot;-&quot;</span>, Treatment),</span>
<span id="cb14-11"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-11" tabindex="-1"></a>  <span class="at">Treatment_Color =</span> Treatment</span>
<span id="cb14-12"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-12" tabindex="-1"></a>)</span>
<span id="cb14-13"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-13" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(group_means, <span class="fu">aes</span>(<span class="at">x =</span> X_Pos, <span class="at">y =</span> Death_rate, <span class="at">color =</span> Treatment_Color)) <span class="sc">+</span></span>
<span id="cb14-14"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb14-15"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Severity), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb14-16"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-16" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb14-17"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-17" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb14-18"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-18" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Mild - A&quot;</span>, <span class="st">&quot;Mild - B&quot;</span>, <span class="st">&quot;Severe - A&quot;</span>, <span class="st">&quot;Severe - B&quot;</span>)</span>
<span id="cb14-19"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-20"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-20" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb14-21"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-21" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Treatment A&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Treatment B&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb14-22"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-22" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Treatment&quot;</span></span>
<span id="cb14-23"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-24"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Risk by Severity (Mild vs. Severe)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Risk of Death&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-25"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-25" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb14-26"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-26" tabindex="-1"></a></span>
<span id="cb14-27"><a href="foundations-of-causal-thinking-in-public-health.html#cb14-27" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code></pre></div>
<p><img src="Causal-Inference-Graduate_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="introduction-to-counterfactuals-and-potential-outcomes" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Introduction to Counterfactuals and Potential Outcomes<a href="foundations-of-causal-thinking-in-public-health.html#introduction-to-counterfactuals-and-potential-outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the heart of causal inference lies a simple yet powerful idea: counterfactuals — what would have happened if something else had occurred. However, we can never observe both outcomes for the same person. This is known as the Fundamental Problem of Causal Inference. We only observe the outcome under the condition that actually occurred — everything else is unobserved, or counterfactual.</p>
<p>Building on the concept of counterfactuals, the Average Treatment Effect (ATE) provides a formal way to quantify the impact of a treatment or intervention across a population. Since we cannot observe both potential outcomes (treated and untreated) for the same individual, ATE instead compares the average outcome we would see if everyone received the treatment versus if no one did. Mathematically, it is the difference between the expected value of the potential outcome under treatment and the expected value under control. While individual causal effects remain unobservable, the ATE offers a population-level summary of the treatment’s impact — a cornerstone of policy evaluation, randomized experiments, and observational causal analysis.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb15-2"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-3" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)           </span>
<span id="cb15-4"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-5" tabindex="-1"></a>bmi <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">4</span>)            </span>
<span id="cb15-6"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-7" tabindex="-1"></a>cholesterol <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="dv">30</span>)  </span>
<span id="cb15-8"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-9" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fu">plogis</span>(<span class="fl">0.05</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fl">0.01</span> <span class="sc">*</span> cholesterol <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb15-10"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-11" tabindex="-1"></a>y_0 <span class="ot">&lt;-</span> <span class="dv">140</span> <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> bmi <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> cholesterol <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb15-12"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-12" tabindex="-1"></a></span>
<span id="cb15-13"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-13" tabindex="-1"></a>y_1 <span class="ot">&lt;-</span> y_0 <span class="sc">-</span> (<span class="dv">40</span> <span class="sc">+</span> <span class="fl">1.0</span> <span class="sc">*</span> age <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> cholesterol) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb15-14"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-15" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="dv">1</span>, y_1, y_0)</span>
<span id="cb15-16"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-16" tabindex="-1"></a></span>
<span id="cb15-17"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-17" tabindex="-1"></a>true_ate <span class="ot">&lt;-</span> <span class="fu">mean</span>(y_1 <span class="sc">-</span> y_0)</span>
<span id="cb15-18"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-18" tabindex="-1"></a></span>
<span id="cb15-19"><a href="foundations-of-causal-thinking-in-public-health.html#cb15-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;True ATE:&quot;</span>, <span class="fu">round</span>(true_ate, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## True ATE: -30.026</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="foundations-of-causal-thinking-in-public-health.html#cb17-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(age, bmi, cholesterol, treatment, y)</span>
<span id="cb17-2"><a href="foundations-of-causal-thinking-in-public-health.html#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="foundations-of-causal-thinking-in-public-health.html#cb17-3" tabindex="-1"></a>naive_ate <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>y[df<span class="sc">$</span>treatment <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(df<span class="sc">$</span>y[df<span class="sc">$</span>treatment <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb17-4"><a href="foundations-of-causal-thinking-in-public-health.html#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="foundations-of-causal-thinking-in-public-health.html#cb17-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Naive (unadjusted) ATE estimate:&quot;</span>, <span class="fu">round</span>(naive_ate, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Naive (unadjusted) ATE estimate: -31.246</code></pre>
</div>
<div id="causal-estimands-and-identification" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Causal Estimands and Identification<a href="foundations-of-causal-thinking-in-public-health.html#causal-estimands-and-identification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Causal estimands are the quantities we aim to estimate to understand the effect of a treatment or intervention. The most common estimands include:<br />
- Average Treatment Effect (ATE): Measures the average difference in outcomes if everyone received the treatment versus if no one did.<br />
- Average Treatment Effect on the Treated (ATT): Measures the effect of treatment for those who actually received the treatment.<br />
- Average Treatment Effect on the Controls (ATC): Measures the effect for those who did not receive the treatment.<br />
- Conditional Average Treatment Effect (CATE): Measures the treatment effect for subgroups defined by observed characteristics (e.g., older vs. younger patients).</p>
<p>Identification is the process of linking a causal estimand (like ATE) to observable data. Without valid identification, any estimates we produce may be biased or incorrect. One major challenge in causal inference is that we can never observe both potential outcomes for the same person — only the outcome under the actual treatment they received. This is the Fundamental Problem of Causal Inference.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="setup.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="randomized-control-trials.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/fbargaglistoffi/causal_inference_graduate/edit/main/01_potential_outcomes.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/fbargaglistoffi/causal_inference_graduate/blob/main/01_potential_outcomes.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
