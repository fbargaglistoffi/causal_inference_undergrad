[["index.html", "Welcome Course Description Instructor Teaching Assistants Course Logistics Required Materials Learning Objectives Upon successful completion of this course, students will be able to: Tools Useful Links Acknowledgments", " Welcome Welcome to the course website for The Science of Why: Causal Inference for Public Health. This course introduces the foundations of causal inference in public health and medical sciences, with an emphasis on distinguishing between association and causation in real-world research. Course Description In this course, students will: Explore foundational concepts such as counterfactuals, causal estimands, and identification strategies. Learn how to critically evaluate causal claims in public health literature. Understand and apply experimental and observational study designs, causal diagrams (DAGs), and bias adjustment methods. Develop practical skills through R-based tutorials and case studies. This course is ideal for undergraduates interested in public health, epidemiology, biostatistics, or social science research. Instructor Falco J. Bargagli-Stoffi Assistant Professor Department of Biostatistics UCLA Fielding School of Public Health falco@ucla.edu Office hours: By appointment. (Book via the scheduling link on this website.) Teaching Assistants TBD — will be announced on the course website. Course Logistics Offered: Fall Term Meetings: Lecture (3 hours), Discussion (1 hour) — in-person unless otherwise announced Assignments: Posted on the course website, due before 8 PM on specified dates Final Project: Group presentation + written report during finals week Required Materials Primary Textbook: Hernán MA, Robins JM. (2023) Causal Inference: What If Free PDF available here Secondary (Recommended) Texts: - Rosenbaum PR. Causal Inference. MIT Press. - Pearl J., Mackenzie D. The Book of Why. Basic Books. Supplementary Readings: Will be shared throughout the course. Learning Objectives Syllabus This course introduces students to the foundations of causal inference in public health and medical sciences, with a strong emphasis on the difference between association and causation. Students will learn to critically evaluate causal claims, understand causal diagrams (DAGs), and assess study design choices in both randomized and observational studies. We will explore how causal effects are identified and estimated, how to detect and adjust for biases (like confounding and selection bias), and how to use critical thinking tools when reviewing public health research. Students will also be introduced to concepts like effect modification, interaction, and systems thinking through real-world applications. Upon successful completion of this course, students will be able to: Communicate public health findings and causal claims in written and oral forms Evaluate causal claims in academic and public health literature Design and assess both randomized trials and observational studies Construct and analyze causal diagrams (DAGs) for identifying sources of bias Apply concepts of effect modification, interaction, and confounding Interpret findings within the context of public health policy and practice Work independently and collaboratively to assess causal research Tools This course will make use of: - R and RStudio - Interactive R tutorials and guided analysis - GitHub for accessing materials and submitting assignments Useful Links UCLA Center for Accessible Education UCLA Equity, Diversity, and Inclusion FSPH EDI Initiative Acknowledgments Special thanks to Charlie Wang, Shravani Chiddarwar and Kevin Ngo for their invaluable help in preparing this course. "],["setup.html", "Setup Installing and Using Required Packages Loading Packages Difference Between install.packages() and library() Session Information Why include this? Base R version (simple)", " Setup Installing and Using Required Packages Throughout this tutorial, we’ll use a few essential R packages to manipulate data, run models, and create plots. Below are the core packages, what they do, and how to install them. Packages we’ll use: ggplot2 – For plotting (e.g., scatterplots, regression lines) dplyr – For data wrangling (filtering, mutating, summarizing, etc.) gridExtra – To combine multiple plots into one figure stats – Comes with base R and used for regression (lm()) pacman – Simplifies package management in R broom (optional) – Makes model summaries easier to work with # install.packages(c(&quot;ggplot2&quot;, &quot;dplyr&quot;, &quot;gridExtra&quot;, &quot;pacman&quot;, &quot;broom&quot;)) Loading Packages library(ggplot2) library(dplyr) library(gridExtra) # Optional if using tidy model outputs: # library(broom) Difference Between install.packages() and library() install.packages(“dplyr”) downloads and installs the package — you only need to do this once per computer. library(dplyr) loads the package into your R session — you need to run this each time you use it. Session Information It’s always good practice to include your session info at the end of your analysis. This gives a snapshot of: Your R version and system details All the packages that were loaded The versions of those packages This is especially useful when: - You’re debugging errors - You’re submitting assignments - You’re collaborating with others Why include this? Sometimes code behaves differently depending on the version of a package or even the version of R itself. Including your session info makes your work reproducible and easier to troubleshoot. Base R version (simple) This function comes with R and gives you basic session details. sessionInfo() ## R version 4.5.1 (2025-06-13) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Sequoia 15.6 ## ## Matrix products: default ## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib; LAPACK version 3.12.1 ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## time zone: America/Los_Angeles ## tzcode source: internal ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] igraph_2.2.1 bnlearn_5.1 cobalt_4.6.0 gridExtra_2.3 dplyr_1.1.4 ggplot2_3.5.2 bookdown_0.46 ## ## loaded via a namespace (and not attached): ## [1] crayon_1.5.3 vctrs_0.6.5 cli_3.6.5 knitr_1.50 rlang_1.1.6 xfun_0.52 ## [7] generics_0.1.4 jsonlite_2.0.0 labeling_0.4.3 glue_1.8.0 htmltools_0.5.8.1 sass_0.4.10 ## [13] scales_1.4.0 rmarkdown_2.29 grid_4.5.1 evaluate_1.0.4 jquerylib_0.1.4 tibble_3.3.0 ## [19] fastmap_1.2.0 yaml_2.3.10 lifecycle_1.0.4 chk_0.10.0 compiler_4.5.1 RColorBrewer_1.1-3 ## [25] pkgconfig_2.0.3 rstudioapi_0.17.1 farver_2.1.2 digest_0.6.37 R6_2.6.1 tidyselect_1.2.1 ## [31] parallel_4.5.1 pillar_1.11.0 magrittr_2.0.3 bslib_0.9.0 withr_3.0.2 tools_4.5.1 ## [37] gtable_0.3.6 cachem_1.1.0 "],["causal-dictionary.html", "Causal Dictionary", " Causal Dictionary We compiled a list of important terms or common questions you might have! This page is useful to refer to throughout the course. Conditioning - A statistical operation to analyze relationships of variables while holding values of other variables constant. For example, if we are analyzing the relationship between \\(X\\) and \\(Y\\) while conditioning on \\(Z\\), we are asking “What is the relationship of \\(X\\) and \\(Y\\) when holding \\(Z\\) constant?” Controlling/Adjusting - Controlling or adjusting for a variable is one way to implement conditioning, particularly in regression contexts. We control for a variable by adding it as a covariate to our regression model. The regression coefficient for \\(X\\) then represents the association between \\(X\\) and \\(Y\\) when \\(Z\\) is held constant. Stratifying/Selecting - Stratifying or selecting is a different way to implement conditioning by subsetting the data to observations that meets certain criteria. We then only analyze that subset of the data. For example, if we are interested in the effect of an energy drink on a person’s awareness levels and we only include college students in the study, then we are stratifying. What is the difference between controlling and stratifying for Z? - For example let \\(Z\\) = sex assigned at birth. Both controlling and stratifying are forms of conditioning. When we control, we add \\(Z\\) as a covariate to our regression model, but our data still contains both males and females. When we stratify for males, then only males are included in our analysis. Though they are both forms of conditioning, controlling or stratifying have different implications for what causal quantity we are actually estimating. Selection bias - Selection bias occurs when the probability of being included in the analysis depends on a factor that affects the association between the treatment and outcome. "],["foundations-of-causal-thinking-in-public-health.html", "1 Foundations of Causal Thinking in Public Health Class materials Textbook reading Supplementary reading Topics covered 1.1 Association vs. Causation 1.2 Introduction to Counterfactuals and Potential Outcomes 1.3 Causal Estimands and Identification 1.4 Measuring Effects for Binary Outcomes", " 1 Foundations of Causal Thinking in Public Health Class materials Slides: Module 1 Recording: Module 1, Part 1.1 Recording: Module 1, Part 2.1 Recording: Module 1, Part 2.2 Textbook reading Hernán &amp; Robins, Causal Inference: What If – Chapters 1 Supplementary reading Pearl, J. and Mackenzie, D. (2018) The Book of Why: The New Science of Cause and Effect. Basic Books. Selected public health news articles (provided on the course site). Topics covered Association vs. Causation Introduction to Counterfactuals and Potential Outcomes Causal Estimands and Identification Measuring Effects for Binary Outcomes Critical reading exercise: analyzing causal claims in public health news 1.1 Association vs. Causation Association refers to a statistical relationship where two variables move together, but one doesn’t necessarily cause the other. For instance, ice cream sales and drowning incidents both rise in the summer, not because one causes the other, but because they share a third factor: temperature. In contrast, causation implies a direct cause-and-effect relationship, where changing one variable leads to changes in another. Establishing causation requires rigorous methods, such as randomized controlled trials, to rule out confounding factors. Simpson’s Paradox occurs when a trend appears in separate groups but reverses when the data are combined. This paradox is driven by confounding variables—unaccounted factors that influence both the treatment and the outcome. It illustrates how aggregated data can be misleading and emphasizes the importance of analyzing relationships within subgroups to avoid drawing incorrect conclusions. To demonstrate this paradox, I simulated a study comparing two pneumonia treatments across 2,000 people Treatment A was mostly given to mild cases, while Treatment B was given to severe cases. When data were analyzed without considering severity, Treatment A seemed more effective. However, when stratified by severity, Treatment B consistently showed lower death rates in both mild and severe groups. This was visualized through two plots: one showing the misleading overall trend, and another stratified by severity revealing the true relationship. # library(ggplot2) # library(dplyr) set.seed(123) n &lt;- 2050 severity &lt;- rep(c(&quot;Mild&quot;, &quot;Severe&quot;), times = c(1450, 600)) treatment &lt;- c(rep(&quot;Treatment A&quot;, 1400), rep(&quot;Treatment B&quot;, 50), rep(&quot;Treatment A&quot;, 100), rep(&quot;Treatment B&quot;, 500)) outcome &lt;- c(rbinom(1400, 1, 0.15), # Mild + A (15% death rate) rbinom(50, 1, 0.10), # Mild + B (10% death rate) rbinom(100, 1, 0.30), # Severe + A (30% death rate) rbinom(500, 1, 0.20)) # Severe + B (20% death rate) df &lt;- data.frame( Severity = severity, Treatment = treatment, Outcome = outcome ) death_counts &lt;- tapply(df$Outcome, list(df$Severity, df$Treatment), sum) table_counts &lt;- table(df$Severity, df$Treatment) death_rates &lt;- round(death_counts / table_counts, 3) overall_a &lt;- sum(df$Outcome[df$Treatment == &quot;Treatment A&quot;]) / sum(df$Treatment == &quot;Treatment A&quot;) overall_b &lt;- sum(df$Outcome[df$Treatment == &quot;Treatment B&quot;]) / sum(df$Treatment == &quot;Treatment B&quot;) print(&quot;Death rates by severity and treatment:&quot;) ## [1] &quot;Death rates by severity and treatment:&quot; print(death_rates) ## Treatment A Treatment B ## Mild 0.136 0.120 ## Severe 0.380 0.204 cat(&quot;Overall death rate (Treatment A):&quot;, round(overall_a, 3), &quot;\\n&quot;) ## Overall death rate (Treatment A): 0.153 cat(&quot;Overall death rate (Treatment B):&quot;, round(overall_b, 3), &quot;\\n&quot;) ## Overall death rate (Treatment B): 0.196 overall_plot_data &lt;- data.frame( X_Pos = c(1, 2), Death_rate = c(overall_a, overall_b), Treatment = c(&quot;Treatment A&quot;, &quot;Treatment B&quot;) ) p1 &lt;- ggplot(overall_plot_data, aes(x = X_Pos, y = Death_rate, color = Treatment)) + geom_point(size = 5) + geom_line(aes(group = 1), color = &quot;black&quot;, linewidth = 1.2) + scale_x_continuous(breaks = c(1, 2), labels = c(&quot;Treatment A&quot;, &quot;Treatment B&quot;)) + scale_color_manual(values = c(&quot;Treatment A&quot; = &quot;red&quot;, &quot;Treatment B&quot; = &quot;blue&quot;)) + labs(title = &quot;Overall Trend (Simpson&#39;s Paradox)&quot;, x = &quot;&quot;, y = &quot;Risk of Death&quot;) + theme_minimal() + guides(color = &quot;none&quot;) print(p1) If we only compare the death rates between groups that received treatment A against groups that received treatment B, treatment A seems to be more effective at treating patients. group_means &lt;- df %&gt;% group_by(Severity, Treatment) %&gt;% summarize(Death_rate = mean(Outcome), .groups = &quot;drop&quot;) %&gt;% mutate(X_Pos = case_when( Severity == &quot;Mild&quot; &amp; Treatment == &quot;Treatment A&quot; ~ 1, Severity == &quot;Mild&quot; &amp; Treatment == &quot;Treatment B&quot; ~ 2, Severity == &quot;Severe&quot; &amp; Treatment == &quot;Treatment A&quot; ~ 3, Severity == &quot;Severe&quot; &amp; Treatment == &quot;Treatment B&quot; ~ 4 ), Group = paste(Severity, &quot;-&quot;, Treatment), Treatment_Color = Treatment ) p2 &lt;- ggplot(group_means, aes(x = X_Pos, y = Death_rate, color = Treatment_Color)) + geom_point(size = 5) + geom_line(aes(group = Severity), color = &quot;black&quot;, linewidth = 1.2) + scale_x_continuous( breaks = 1:4, labels = c(&quot;Mild - A&quot;, &quot;Mild - B&quot;, &quot;Severe - A&quot;, &quot;Severe - B&quot;) ) + scale_color_manual( values = c(&quot;Treatment A&quot; = &quot;red&quot;, &quot;Treatment B&quot; = &quot;blue&quot;), name = &quot;Treatment&quot; ) + labs(title = &quot;Risk by Severity (Mild vs. Severe)&quot;, y = &quot;Risk of Death&quot;, x = &quot;&quot;) + theme_minimal() print(p2) Only after stratifying by the severity of the case are we able to observe that treatment B is actually more effective than treatment A for both mild and severe pneumonia cases. 1.2 Introduction to Counterfactuals and Potential Outcomes At the heart of causal inference lies a simple yet powerful idea: counterfactuals — what would have happened if something else had occurred. However, we can never observe both outcomes for the same person. This is known as the Fundamental Problem of Causal Inference. We only observe the outcome under the condition that actually occurred — everything else is unobserved, or counterfactual. Building on the concept of counterfactuals, the Average Treatment Effect (ATE) provides a formal way to quantify the impact of a treatment or intervention across a population. Since we cannot observe both potential outcomes (treated and untreated) for the same individual, ATE instead compares the average outcome we would see if everyone received the treatment versus if no one did. Mathematically, it is the difference between the expected value of the potential outcome under treatment and the expected value under control. While individual causal effects remain unobservable, the ATE offers a population-level summary of the treatment’s impact — a cornerstone of policy evaluation, randomized experiments, and observational causal analysis. Counterfactuals can be represented using potential outcomes notation. Here is the basic notation: \\(Y\\;=\\;\\) the observed outcome \\(Y(0)\\;=\\;\\) the potential outcome under no treatment \\(Y(1)\\;=\\;\\) the potential outcome under treatment \\(W\\;=\\;\\) a binary variable that represents whether a unit was treated or not. If \\(W = 1\\), then the unit was treated. If \\(W = 0\\), then the unit was not treated. Notice that the observed outcome can be expressed in terms of potential outcomes: \\(Y = (W)Y(1) + (1-W)Y(0)\\). So \\(Y = Y(1)\\) if the unit was treated and \\(Y = Y(0)\\) if the unit was not treated. The previous equation is known as consistency. The simulation below is testing the effect of a treatment on 2000 patients. The treatment was assigned to older people with higher levels of cholesterol. If we simply take the difference of the average outcome of the treated group and average outcome of the control group, then our estimate of the average treatment effect will be biased because age and cholesterol levels are confounding the effect of the treatment. This is shown by how the true average treatment effect differs from naive average treatment effect estimate. set.seed(123) n &lt;- 2000 age &lt;- rnorm(n, mean = 50, sd = 10) bmi &lt;- rnorm(n, mean = 25, sd = 4) cholesterol &lt;- rnorm(n, mean = 200, sd = 30) # More extreme treatment assignment: strong bias toward older, high-cholesterol people treatment &lt;- rbinom(n, 1, plogis(0.2 * age + 0.05 * cholesterol - 25)) # True untreated outcome y_0 &lt;- 140 - 1.5 * age + 0.3 * bmi + 0.5 * cholesterol + rnorm(n, sd = 5) # True treated outcome: better, but depends on age &amp; cholesterol y_1 &lt;- y_0 - (40 + 1.5 * age - 0.8 * cholesterol) + rnorm(n, sd = 2) # Observed outcome y &lt;- ifelse(treatment == 1, y_1, y_0) # True ATE: average of individual-level effects true_ate &lt;- mean(y_1 - y_0) df &lt;- data.frame(age, bmi, cholesterol, treatment, y) # Naive estimate: difference in means naive_ate &lt;- mean(df$y[df$treatment == 1]) - mean(df$y[df$treatment == 0]) cat(&quot;True ATE:&quot;, round(true_ate, 3), &quot;\\n&quot;) ## True ATE: 44.567 cat(&quot;Naive (unadjusted) ATE estimate:&quot;, round(naive_ate, 3), &quot;\\n&quot;) ## Naive (unadjusted) ATE estimate: 49.021 1.3 Causal Estimands and Identification Causal estimands are the quantities we aim to estimate to understand the effect of a treatment or intervention. The most common estimands include: Average Treatment Effect (ATE): Measures the average difference in outcomes if everyone received the treatment versus if no one did. \\[ ATE = E[Y(1)-Y(0)] \\] Average Treatment Effect on the Treated (ATT): Measures the effect of treatment for those who actually received the treatment. \\[ ATT = E[Y(1) - Y(0)\\ | \\ W = 1] \\] Average Treatment Effect on the Controls (ATC): Measures the effect for those who did not receive the treatment. \\[ ATC = E[Y(1) - Y(0)\\ | \\ W = 0] \\] Conditional Average Treatment Effect (CATE): Measures the treatment effect for subgroups defined by observed characteristics (e.g., older vs. younger patients). \\[ CATE = E[Y(1) - Y(0)\\ | \\ X = x] \\] Think of \\(X=x\\) where \\(X\\) is some form of age classification and \\(x\\) could be a value of the age classifcation, such as younger or older. Identification is the process of linking a causal estimand (like ATE) to observable data. Without valid identification, any estimates we produce may be biased or incorrect. One major challenge in causal inference is that we can never observe both potential outcomes for the same person — only the outcome under the actual treatment they received. This is the Fundamental Problem of Causal Inference. 1.4 Measuring Effects for Binary Outcomes Often times in public health settings, we have to estimate the causal effect on a binary outcome such as survival. For example, if we are trying to measure the effect of a heart surgery on a patient’s survival status, we can say that the outcome \\(Y = 1\\) means that the patient died and \\(Y = 0\\) means that the patient survived. There are only two possible outcomes. In this case, we try to quantify or measure the causal effect using two main effect measures. \\[ Pr[Y(1) = 1] - Pr[Y(0) = 1] \\quad \\text{(Risk Difference)} \\\\ \\] The risk difference measures average individual causal effects additively. For example, if we estimated the heart surgery to have a risk difference of -0.5, then on average, the surgery reduced the probability of death by 0.5. \\[ \\frac{Pr[Y(1) = 1]}{Pr[Y(0) = 1]} \\quad \\text{(Risk Ratio)} \\\\ \\] The risk ratio measures causal effects multiplicatively. For example if the heart surgery was estimated to have a risk ratio of 0.5, then the risk of death under surgery is half compared to the risk of death under no surgery. Since we are working with binary outcomes, we can model these probabilities using a logistic regression. Let’s consider the example about measuring the effect of heart surgery. To estimate the risk difference using a logistic regression, we follow a set of steps called g-computation: Fit a logistic regression model to the observed data Set the treatment status of all units to 1 and predict \\(Y(1)\\). This gets the probability of \\(Y = 1\\) had each unit been treated. Set the treatment status of all units to 0 and predict \\(Y(0)\\). This gets the probability of \\(Y = 1\\) had each unit been untreated. Use (2) and (3) to estimate a risk difference or risk ratio In the example below, we are trying to measure the causal effect of a heart transplant on a patient’s survival status. Our study includes 200 total patients. We have data on the patient’s age, health score (ranging from 0 to 100, where a higher score means more healthy), whether they are diabetic, and whether they have had a prior heart attack. Patients that tend to be older, less healthy, have had diabetes, or have had a prior heart attack are more likely to receive the surgery. Out of 200 patients, 127 did not receive heart surgery, while 73 did. For simulation purposes, the true risk difference is -0.093 and the risk ratio is 0.76. This means that the heart surgery reduces chance of death by 9.3 percentage points on average according to the risk difference. The risk ratio of 0.76 means that the probability of death under surgery is 76% of the probability of death under no surgery, which is a 28% decrease relative to the probability of death under no surgery. Visual Steps for g-computation #library(e1071) #library(dplyr) ### Step 1: Data Generating Process set.seed(123) n &lt;- 200 # 200 subjects in study # simulate covariates age &lt;- rnorm(n, 60, 12) age &lt;- pmax(25, pmin(90, age)) # cap age to range from 25 to 90 health_score &lt;- rnorm(n , 60, 15) health_score &lt;- pmax(0, pmin(100, health_score)) # cap health scores between 0 and 100 diabetic &lt;- rbinom(n, 1, 0.25) # 25% chance of diabetes prior_heart_attack &lt;- rbinom(n, 1, 0.3) # 30% chance of heart attack # generate potential linear predictions for all units (lp0 = untreated, lp1 = treated) lp0 &lt;- -0.98 + 0.034*age - 0.036*health_score + 0.53*diabetic + 0.79*prior_heart_attack lp1 &lt;- lp0 - 0.51 # convert linear predictions to probabilites using sigmoid function p0 &lt;- plogis(lp0) p1 &lt;- plogis(lp1) # generate probabilites of getting treated based on covariates to assign treatment status to each unit W_linear &lt;- -1 + 0.03*age - 0.03*health_score + 0.7*diabetic + 0.6*prior_heart_attack W_prob &lt;- plogis(W_linear) W &lt;- rbinom(n, 1, W_prob) # generate observed outcomes Y0 &lt;- rbinom(n, 1, p0) Y1 &lt;- rbinom(n, 1, p1) Y &lt;- ifelse(W == 1, Y1, Y0) df &lt;- data.frame(age, health_score, diabetic, prior_heart_attack, W, Y) # observed data ### Step 2: Estimating causal effects using g-computation model &lt;- glm(Y~W+age+health_score+diabetic+prior_heart_attack, data = df, family = binomial(link = &quot;logit&quot;)) # fit logistic regression model df_treat &lt;- df |&gt; mutate(W = 1) # create a copy of observed data where all units are treated df_untreat &lt;- df |&gt; mutate(W = 0) # create a copy of observed data where all units are not treated # predict potential outcomes (in probabilities) using model p0_hat &lt;- predict(model, newdata = df_untreat, type = &quot;response&quot;) p1_hat &lt;- predict(model, newdata = df_treat, type = &quot;response&quot;) cat(&quot;True Risk Difference: &quot;, mean(p1) - mean(p0), &quot;\\n&quot;) ## True Risk Difference: -0.09344478 cat(&quot;True Risk Ratio: &quot;, mean(p1) / mean(p0), &quot;\\n&quot;) ## True Risk Ratio: 0.7216753 cat(&quot;\\n&quot;) cat(&quot;Estimated Risk Difference: &quot;, mean(p1_hat) - mean(p0_hat), &quot;\\n&quot;) ## Estimated Risk Difference: -0.07962482 cat(&quot;Estimated Risk Ratio: &quot;, mean(p1_hat) / mean(p0_hat), &quot;\\n&quot;) ## Estimated Risk Ratio: 0.7645678 Though they are not perfect estimates, we were able to estimate the risk differences and ratios using g-computation. "],["randomized-control-trials.html", "2 Randomized Control Trials Class materials Textbook reading Supplementary reading Topics covered 2.1 Randomized controlled trials: the gold standard 2.2 Basic Experimental Design Principles 2.3 Limitations of RCTs in Public Health Contexts 2.4 Common Threats to Internal and External Validity 2.5 Causal Quantities: SATE vs PATE", " 2 Randomized Control Trials Class materials Slides: Module 2 Recording: Module 2, Part 1 Recording: Module 2, Part 2 Textbook reading **Hernán &amp; Robins, Causal Inference: What If – Chapters 2* Supplementary reading Pearl, J. (2009). Causal inference in statistics: An overview. Statistics Surveys, 3, 96–146.  Selected DAG examples from public health studies (provided in class) Topics covered Randomized controlled trials: the gold standard Basic experimental design principles Limitations of RCTs in public health contexts Common threats to internal and external validity Causal Quantities: SATE vs PATE Critical reading exercise: evaluating a published RCT 2.1 Randomized controlled trials: the gold standard Randomized Controlled Trials (RCTs) are widely considered the gold standard in causal inference because they offer the most rigorous way to establish whether a treatment or intervention truly causes an outcome. The key feature that sets RCTs apart is randomization: participants are randomly assigned to treatment or control groups, which ensures that—on average—all other characteristics (like age, health status, and behaviors) are equally distributed across groups. This process breaks any systematic link between confounders and treatment assignment, making the groups exchangeable and allowing us to interpret differences in outcomes as causal effects of the treatment. Exchangeability is the key assumption for RCTs, and random assignment of the treatment in RCTs allows us to defend this assumption. Mathematically, exchangeability is written as: \\[ (Y(1), Y(0)) \\perp W \\] To understand this consider an single person. Exchangeability says that if we have information about what treatment they received, then that doesn’t give us any information about what their potential outcome will be. We use exchangeability to identify the average treatment effect (ATE). Identifying the ATE means we are using some assumptions to express the ATE which is expressed in counterfactual outcomes as something that can be expressed using observed data. In this case, the ATE can be written as a difference in means between the treated and control groups. \\[ \\begin{align*} ATE &amp;= E[Y(1) - Y(0)] \\\\ &amp;= E[Y(1)] - E[Y(0)] \\quad \\text{by linearity of expectation} \\\\ &amp;= E[Y(1) \\ | \\ W=1] - E[Y(0) \\ | \\ W = 0] \\quad \\text{by exchangeability} \\\\ &amp;= E[Y \\ | \\ W = 1] - E[Y \\ | \\ W = 0] \\quad \\text{by consistency} \\end{align*} \\] Because of this design, RCTs eliminate the need to adjust for confounders or worry about selection bias in the same way observational studies do. They provide clean estimates of the average treatment effect (ATE) with high internal validity, especially when they are well-executed and have minimal loss to follow-up. However, RCTs are not without limitations. They can be expensive, time-consuming, and sometimes unethical or impractical—such as when withholding treatment would cause harm. Despite these limitations, RCTs serve as the benchmark against which other study designs are compared, and understanding their strengths helps us interpret both experimental and non-experimental evidence more critically. In this simulation, I will recreate a simple randomized controlled trial (RCT) to estimate the effect of a new treatment on a patient’s blood pressure (mmHg). I randomly assigned 2,000 individuals to either a treatment or control group and simulate their outcomes based on their assignment. Because of randomization, I expected the two groups to be similar in baseline characteristics, allowing for an unbiased estimate of the treatment effect. In this example, the baseline characteristics that were measured were age, BMI, cholesterol (mg/dL), and daily sodium intake (mg/day). After simulating the data, I estimated the Average Treatment Effect (ATE) by comparing mean outcomes between the groups, and visualized the distribution of outcomes to confirm the treatment impact. Simulated Baseline Data and Treatment Assignment # pacman::p_load(&quot;dplyr&quot;, &quot;ggplot2&quot;) set.seed(123) n &lt;- 2000 age &lt;- rnorm(n, 50, 10) bmi &lt;- rnorm(n, 27, 4) cholesterol &lt;- rnorm(n, 200, 30) sodium_intake &lt;- rnorm(n, 3000, 500) treatment &lt;- rbinom(n, 1, 0.5) y_0 &lt;- 90 + 0.4 * age + 0.05 * cholesterol + 0.004 * sodium_intake + rnorm(n, sd = 10) y_1 &lt;- y_0 - 10 + rnorm(n, sd = 5) y &lt;- ifelse(treatment == 1, y_1, y_0) rct_data &lt;- data.frame( age = age, bmi = bmi, cholesterol = cholesterol, sodium_intake = sodium_intake, treatment = treatment, y = y ) head(rct_data) ## age bmi cholesterol sodium_intake treatment y ## 1 44.39524 24.95359 205.8965 2650.386 1 139.3092 ## 2 47.69823 27.94775 219.5034 3498.226 0 127.8826 ## 3 65.58708 24.83364 220.1301 2653.627 1 123.6146 ## 4 50.70508 31.87691 161.4753 2948.258 1 104.0808 ## 5 51.29288 27.69654 139.2167 3301.933 0 157.9980 ## 6 67.15065 24.53893 266.1598 2695.978 1 125.1818 Estimated the Average Treatment Effect (ATE) ate_estimate &lt;- rct_data |&gt; group_by(treatment) |&gt; summarize(mean_outcome = mean(y)) |&gt; summarize(ATE = diff(mean_outcome)) |&gt; pull(ATE) paste(&quot;Estimated ATE: &quot;, round(ate_estimate, 2)) ## [1] &quot;Estimated ATE: -10.01&quot; Based on our estimate, the treatment reduces blood pressure by 10 mmHg. Visualization of the Outcome Distributions ggplot(rct_data, aes(x = as.factor(treatment), y = y, fill = as.factor(treatment))) + geom_boxplot(alpha = 0.7) + labs( title = &quot;Distribution of Outcomes by Treatment Group&quot;, x = &quot;Treatment: Control (0) vs Treated (1)&quot;, y = &quot;Outcome&quot; ) + scale_fill_manual(values = c(&quot;red&quot;, &quot;blue&quot;)) + theme_minimal() # library(cobalt) bal.out &lt;- bal.tab(treatment~age+bmi+cholesterol+sodium_intake, data = rct_data, s.d.denom = &quot;pooled&quot;) set.cobalt.options(binary = &quot;std&quot;) love.plot(bal.out, limits = c(-0.1, 0.1)) This visualization is called a love plot. It shows how balanced each of the observed characteristics is between the treated and control group. For example, a value of 0.05 for age means that the treated group’s mean age is 0.05 standard deviations above the control group’s mean age, which is not much. Typically, an absolute standardized difference value of 0.10 or less typically means that the difference between the groups is negligible. So in this plot, all the observed characteristics are balanced. This example shows that random assignment of the treatment balances observed and unobserved characteristics. Since the groups are so similar, we say that the treated and control groups are exchangeable. 2.2 Basic Experimental Design Principles At the heart of randomized controlled trials (RCTs) lies experimental design, the set of strategies we use to ensure that the comparison between groups is fair, unbiased, and informative. Good experimental design ensures that any differences in outcomes between the treatment and control groups can be confidently attributed to the treatment itself, and not to other confounding variables. Three basic principles guide experimental design: randomization, control, and replication. Randomization is the process of randomly assigning participants to treatment or control groups. This prevents systematic differences between groups at baseline and ensures that confounding variables (both known and unknown) are evenly distributed. Control involves creating a baseline group (the control group) that does not receive the treatment, allowing for a meaningful comparison. Replication refers to having enough participants so that random fluctuations even out, providing more precise and reliable estimates of the treatment effect. In our previous simulation, we applied these principles by randomly assigning 2,000 individuals to either a treatment or control group, simulating outcomes based only on treatment status and baseline characteristics (age). Because we randomized treatment assignment, we can be confident that any observed difference in outcomes is causally attributable to the treatment, not to age differences, baseline health, or other confounders. Without randomization, we would have needed to control for these factors. This simulation highlights why randomization is considered the gold standard for causal inference. 2.3 Limitations of RCTs in Public Health Contexts While randomized controlled trials (RCTs) are the gold standard for establishing causality, they are not without important limitations when applied to public health settings. First, ethical constraints often limit what interventions can be randomly assigned. For example, it would be unethical to randomly assign people to smoke or not smoke in order to study lung cancer. Public health research must often rely on observational studies where randomization is impossible. Second, feasibility and cost can be major barriers. Conducting large-scale RCTs can require enormous resources, making them impractical for studying widespread or long-term public health interventions like school nutrition programs or climate effects on health. Generalizability is another concern. Many RCTs are conducted in tightly controlled environments with selective populations, meaning their results may not apply to broader, more diverse real-world populations. In our earlier simulation, randomization guaranteed an unbiased estimate of the average treatment effect (ATE) within the study population. However, in real-world public health research, participants who volunteer for RCTs may differ from the general public, and interventions may behave differently outside of controlled settings. This highlights the importance of thinking critically about how experimental results translate into everyday public health practice. 2.4 Common Threats to Internal and External Validity When evaluating any causal study, it’s critical to think about validity, whether the results are accurate (internal validity) and whether they generalize beyond the study setting (external validity). Internal validity refers to whether the observed effect truly reflects the causal effect within the study population. Threats to internal validity include: Confounding, if randomization fails or is compromised (e.g., noncompliance with assigned treatment). Selection bias, if participants drop out or are lost to follow-up in a way that is related to both treatment and outcome. Measurement error, if outcomes or treatments are recorded inaccurately. External validity, on the other hand, concerns whether results from the study can be generalized to other settings, populations, or time periods. Threats to external validity include: Non-representative samples, such as RCTs recruiting only highly motivated individuals who differ from the general population. Intervention differences, where the way a treatment is delivered in a trial setting doesn’t match how it would be implemented in the real world. Contextual factors, such as cultural, economic, or healthcare system differences that make the same intervention work differently elsewhere. In the earlier RCT simulation, we achieved excellent internal validity because treatment was randomized perfectly and outcomes were cleanly measured. However, that simulation assumes an idealized setting; in real public health research, threats to validity often creep in, and careful design and critical thinking are needed to recognize and minimize them. 2.5 Causal Quantities: SATE vs PATE When we do an RCT, we must be careful about the causal quantity of interest we are trying to estimate. If we are interested in understanding the effect of a treatment for just the individuals in our sample, then we are estimating the Sample Average Treatment Effect (SATE). \\[ \\begin{align*} SATE = \\frac{1}{n}\\sum_{i=1}^n (Y_i(1) - Y_i(0)) \\end{align*} \\] Intuitively, the SATE is the average causal effect of individuals in your sample. These results cannot be generalized to a greater population without some assumptions about how sampling was conducted. If we are trying to understand a causal effect on an entire population beyond just our sample, then we are trying to estimate the Population Average Treatment Effect (PATE). The PATE requires an extra component to the study’s design. To estimate the PATE, random sampling must occur to ensure that the sample is representative of the population. This allows us to make conclusions about the population from our sample. \\[ \\begin{align*} PATE &amp;= E[Y(1) - Y(0)] \\end{align*} \\] The main difference between the SATE and PATE is that the PATE has an extra assumption about randomly sampling from the population. This assumption let’s us make conclusions about the causal effect for the entire population, rather than only the sample. Both estimands can be estimated using the difference in means estimator \\(\\hat{\\tau}\\): \\[ \\begin{align*} \\hat{\\tau} &amp;= \\frac{1}{n_1} \\sum_{i=1}^{n} W_iY_i - \\frac{1}{n_0} \\sum_{i = 1}^{n}(1-W_i)Y_i \\end{align*} \\] Since the difference in means estimator is used to estimate both estimands, we have to be extremely careful in specifying whether we are trying to estimate the SATE or PATE. "],["observational-studies.html", "3 Observational Studies Class materials Textbook reading Supplementary reading Topics covered 3.1 The challenge of confounding in public health and medical research 3.2 Exchangeability, positivity, and SUTVA 3.3 Effect Identification in Observational Studies", " 3 Observational Studies Class materials Slides: Module 3 Recording: Module 3, Part 1 Recording: Module 3, Part 2 Textbook reading Hernán &amp; Robins, Causal Inference: What If – Chapter 3 Supplementary reading Greenland, S. (2003). Quantifying biases in causal models: classical confounding vs collider-stratification bias. Epidemiology, 14(3), 300–306.  Additional DAG exercises provided in class Topics covered The challenge of confounding in public health and medical research Exchangeability, positivity, and consistency Effect identification in observational studies Critical reading exercise: evaluating a published observational study 3.1 The challenge of confounding in public health and medical research Confounding is a major challenge in public health and medical research because it can create misleading associations between exposures and outcomes. A confounder is a third variable that is associated with both the exposure and the outcome, potentially distorting the true causal relationship. For example, if we observe that people who carry lighters tend to have higher rates of lung cancer, we might wrongly conclude that carrying a lighter causes cancer. In reality, smoking is the confounding variable: smokers are more likely to carry lighters and also more likely to develop lung cancer. Without properly adjusting for confounders, studies risk producing biased estimates, leading to incorrect conclusions about risk factors, treatments, or interventions. Addressing confounding is crucial but not always straightforward. Methods such as stratification, multivariable regression, propensity score matching, and randomized controlled trials (RCTs) are commonly used to try to adjust for or eliminate confounding effects. However, identifying all relevant confounders can be difficult, especially when dealing with observational data where randomization is not possible. Unmeasured or unknown confounders remain a constant threat to validity. Therefore, careful study design, domain knowledge, and sensitivity analyses are essential to minimize the impact of confounding and ensure more reliable and actionable public health research findings. Example Setup Let’s say we want to study the effect of Exercise (X) on Heart Health (Y), but there’s a Genetic Factor (Z) that causes both Exercise and Heart Health. In this case, Z is a confounder, and we should adjust for it. In this simulation we will have two models: a naive model and an adjusted model. The naive model will only regression heart health on exercise. The adjusted model will regress heart health on exercise and genetic factors, which controls for genetic factor being a confounder. Since this is simulated example, we know that the true effect of exercise on heart health is 0.8. We will see in this example that the estimated causal effect coming from the adjusted model is better than the naive model. n &lt;- 2000 genetics &lt;- rnorm(n) exercise &lt;- 0.6 * genetics + rnorm(n) heart_health &lt;- 0.8 * exercise + 0.5 * genetics + rnorm(n) df &lt;- data.frame(heart_health, exercise, genetics) model_naive &lt;- lm(heart_health ~ exercise, data = df) summary(model_naive)$coefficients[&quot;exercise&quot;, ] ## Estimate Std. Error t value Pr(&gt;|t|) ## 1.03016476 0.02112469 48.76592135 0.00000000 model_adjusted &lt;- lm(heart_health ~ exercise + genetics, data = df) summary(model_adjusted)$coefficients[&quot;exercise&quot;, ] ## Estimate Std. Error t value Pr(&gt;|t|) ## 8.147942e-01 2.264878e-02 3.597519e+01 6.330480e-219 # library(ggplot2) naive_estimate &lt;- summary(model_naive)$coefficients[&quot;exercise&quot;, &quot;Estimate&quot;] adjusted_estimate &lt;- summary(model_adjusted)$coefficients[&quot;exercise&quot;, &quot;Estimate&quot;] estimates &lt;- data.frame( Model = c(&quot;Naive&quot;, &quot;Adjusted&quot;), Estimate = c(naive_estimate, adjusted_estimate) ) ggplot(estimates, aes(x = Model, y = Estimate, fill = Model)) + geom_col(width = 0.5) + labs(title = &quot;Comparison of Naive vs Adjusted Estimates&quot;, y = &quot;Estimated Effect of Exercise&quot;, x = &quot;&quot;) + geom_hline(yintercept = 0.8, linetype = 2) + annotate(&quot;text&quot;, x = 2.45, y = 0.85, label = &quot;True effect&quot;) + theme_minimal() + theme(legend.position = &quot;none&quot;) In this simulation, we model a situation where Genetics (Z) is a confounder that influences both Exercise (X) and Heart Health (Y). The naive model, which regresses Heart Health on Exercise without adjusting for Genetics, gives a biased estimate of the effect of Exercise (1.05). This happens because part of the observed association is actually due to Genetics, not Exercise itself. When we adjust for Genetics in the second model, the estimate of Exercise’s effect (0.84) becomes more accurate, isolating its true relationship with Heart Health. This is shown in how the bar for the adjusted graph is closer to the dotted black line, which represents the true causal effect of exercise (0.8). This example highlights how failing to account for confounding can lead researchers to overstate or misinterpret causal effects in public health and medical studies. 3.2 Exchangeability, positivity, and SUTVA In causal inference, particularly when analyzing observational data, three critical assumptions must hold for estimates to reflect true causal relationships: exchangeability, positivity, and SUTVA. These assumptions ensure that the comparisons we make between groups are valid and that the effects we estimate correspond to real-world interventions. Without them, causal conclusions can be biased or entirely invalid. Exchangeability means that after adjusting for confounders, the treatment and comparison groups are similar in all relevant ways except for the exposure itself. In potential outcomes notation, this is written as: \\[ (Y(0), Y(1)) \\perp W|X \\] Positivity means that every individual has a nonzero probability of receiving each level of the exposure, regardless of their confounder values. In the notation, the “for any \\(x \\in \\mathcal{X}\\)” is saying that within in each group \\(x\\) that the random variable \\(X\\) can take, the unit has a nonzero chance to receive treatment (and control). \\[ 0 &lt; Pr(W = 1 \\ | \\ X = x) &lt; 1 \\quad \\text{for any } x \\in \\mathcal{X} \\] Positivity is not always an assumption that is satisfied. For example, let’s say you are trying to estimate the effect of a new drug. You want to control for the patient’s sex assigned at birth (male or female) to try to estimate the causal effect. However, the drug is never given to females. Then this assumption is violated. Stable Unit Treatment Value Assumption (SUTVA) is our last important assumption. There are two parts to SUTVA: Consistency means that the observed outcome under the observed treatment status of unit \\(i\\) is the same as the potential outcome under the potential treatment status of unit \\(i\\). This usually occurs when there is a single well-defined treatment, such as a drug with a specific dosage. Consistency can be violated if there are multiple versions of the treatment, usually because it is not well defined. For example, there could be a treatment that gives 50 mg of the drug and another version that gives 100 mg of the drug. Here, consistency will be violated. In potential outcomes notation, this is: \\[ Y = (W)Y(1) + (1-W)Y(0) \\] No-interference means that the potential outcomes of unit \\(i\\) are independent of the treatments other units receive. An example of when there is interference is when we are trying to test a vaccine’s effectiveness of preventing measles for an individual. Let’s say in our study, Falco receives the vaccine, and his friend Chad receives a control. Falco and Chad both interact regularly. Assume the vaccine truly reduces the risk of catching measles. Since Falco received the vaccine, he has a lower risk of catching measles, which lowers Chad’s risk of catching measles, even though Chad never received the vaccine. So Chad’s potential risk of contracting measles is a function of whether he receives the vaccine or not and whether Falco receives the vaccine or not. Thus, the no-interference assumption is violated in this case. In potential outcomes notation, we say the potential outcome for unit \\(i\\) is not a function of the treatment status of another unit \\(j\\): \\[ Y_i(W_i) = Y_i(W_i,W_j) \\quad \\text{for all } j \\neq i \\] In our previous simulation studying exercise and heart health, adjusting for genetics aimed to restore exchangeability by balancing genetic differences between individuals with different exercise levels. Positivity was satisfied because individuals at all levels of genetics still varied in how much they exercised. Consistency was assumed because the way we measured exercise and heart health accurately reflected the underlying causal relationship. Together, these assumptions allowed us to interpret the adjusted effect of exercise on heart health as a causal effect. 3.3 Effect Identification in Observational Studies In observational studies, identifying causal effects is challenging because researchers do not control exposure assignments. Unlike randomized controlled trials, individuals self-select into exposure groups, leading to potential confounding. Effect identification requires careful strategies to mimic the conditions of randomization and ensure that observed associations reflect true causal relationships rather than biases from confounding or selection. Confounding control: Adjust for confounders through methods like regression, stratification, matching, or weighting to approximate randomization. Assumptions: Rely on assumptions like exchangeability, positivity, and consistency to justify causal interpretation. Sensitivity analysis: Explore how robust the estimated effect is to potential unmeasured confounding. In our simulation of exercise and heart health, we identified the causal effect of exercise by adjusting for the confounding effect of genetics. Without randomization, genetics could have biased the relationship between exercise and health outcomes. By including genetics as a covariate in our model, we attempted to recreate the conditions needed for causal identification in an observational setting, relying on the assumptions of exchangeability, positivity, and consistency to interpret the adjusted exercise effect as causal. "],["effect-modification-and-interaction.html", "4 Effect Modification and Interaction Class materials Textbook reading Supplementary reading Topics covered 4.1 Effect Modification and Adjustment Methods 4.2 Interaction 4.3 Identifying Interaction 4.4 Effect Modification vs Interaction", " 4 Effect Modification and Interaction Class materials Slides: Module 4 Recording: Module 4, Part 1 Recording: Module 4, Part 2 Textbook reading Hernán &amp; Robins, Causal Inference: What If – Chapters 4–5 Supplementary reading Freedman, D. A. (2008). On types of scientific inquiry: The role of RCTs in health policy. Journal of the Royal Statistical Society: Series A, 171(2), 359–385.  Examples of quasi-experiments from public health and education Topics covered Effect modification and adjustment methods Interaction Identifying interaction Effect modification vs interaction Critical reading exercise: evaluating effect modification and interaction in studies 4.1 Effect Modification and Adjustment Methods Effect modification occurs when the effect of an exposure on an outcome differs depending on the level of another variable. Unlike confounding, which biases the estimated effect, effect modification reflects a real variation in the causal effect across different subgroups. Recognizing effect modification is important because it can reveal that a treatment or exposure is beneficial for some groups but not for others. Adjustment methods like stratification or including interaction terms in regression models help detect and describe effect modification rather than “control” it away. When we study effect modification, we are asking causal questions such as “What the effect of a treatment for group 1 vs the effect for group 2?” Adjustment methods typically aim to control for confounding, but they can also be used to detect effect modification when interaction terms are included. When effect modification is present, a single summary effect estimate (like an overall average) can be misleading. Instead, researchers often report subgroup-specific effects. Careful modeling and interpretation are necessary to distinguish between true effect modification and residual confounding. Simulation to Demonstrate Effect Modification Let’s say we are interested in understanding the effect of new drug on a person’s VO2 max for young vs old people. For example, this drug might be more effective for young people. VO2 max is the maximum amount of oxygen your body can utilize during exercise. VO2 max is measured in mL per kg of body weight per minute. In this simulation, the drug increases VO2 max by 4 mL/kg/min for old people, and 7.5 mL/kg/min for young people. set.seed(123) n &lt;- 2000 treatment &lt;- rbinom(n, 1, 0.5) # drug age_group &lt;- rbinom(n, 1, 0.5) # 1 = young, 0 = old baseline &lt;- 35 # baseline VO2 max is 35 mL/kg/min vo2_max &lt;- baseline + 4 * treatment + 0.5 * age_group + 3.5 * (treatment * age_group) + rnorm(n, mean = 0, sd = 1) df &lt;- data.frame(vo2_max, treatment, age_group) naive_model &lt;- lm(vo2_max ~ treatment + age_group, data = df) adjusted_model &lt;- lm(vo2_max ~ treatment + age_group + treatment * age_group, data = df) summary(naive_model) ## ## Call: ## lm(formula = vo2_max ~ treatment + age_group, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.7165 -0.9743 -0.0066 0.9249 3.8438 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 34.17826 0.04955 689.75 &lt;2e-16 *** ## treatment 5.76923 0.05850 98.62 &lt;2e-16 *** ## age_group 2.18968 0.05850 37.43 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1.306 on 1997 degrees of freedom ## Multiple R-squared: 0.8527, Adjusted R-squared: 0.8526 ## F-statistic: 5780 on 2 and 1997 DF, p-value: &lt; 2.2e-16 summary(adjusted_model) ## ## Call: ## lm(formula = vo2_max ~ treatment + age_group + treatment * age_group, ## data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.0857 -0.6261 -0.0042 0.6543 3.3876 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 34.98227 0.04273 818.756 &lt; 2e-16 *** ## treatment 4.05124 0.06246 64.866 &lt; 2e-16 *** ## age_group 0.49082 0.06211 7.903 4.47e-15 *** ## treatment:age_group 3.43225 0.08828 38.880 &lt; 2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.9855 on 1996 degrees of freedom ## Multiple R-squared: 0.9162, Adjusted R-squared: 0.9161 ## F-statistic: 7272 on 3 and 1996 DF, p-value: &lt; 2.2e-16 If we look only at the naive model without considering effect modification, then we would have incorrectly concluded that the drug impacts young and old people in the same way, adding 5.76 mL/kg/min to a patient’s VO2 max on average. If we look at the adjusted model considering effect modification, then we see that we more accurately estimate the ground truths. We also have the correct interpretation that the drug’s effect varies depending on whether the patient is young or old. For old people, the drug is estimated to increase the VO2 max by 4.05. For young people, the drug is estimated to increase the VO2 max by 4.05 + 3.43 = 7.48. So the drug is 3.43 units more effective in young people. The following plot shows how younger patients benefit more from the drug than older patients. df_grouped &lt;- df |&gt; mutate(age_group = ifelse(age_group == 1, &quot;Young&quot;, &quot;Old&quot;)) ggplot(df_grouped, aes(x = treatment, y = vo2_max, color = age_group)) + geom_jitter(width = 0.1, alpha = 0.4) + stat_summary(fun = mean, geom = &quot;point&quot;, size = 3, shape = 18) + stat_summary(fun = mean, geom = &quot;line&quot;, aes(group = age_group)) + scale_x_continuous(breaks = c(0, 1)) + labs(title = &quot;Effect Modification: Drug and Age Category&quot;, x = &quot;Treatment (0 = Control, 1 = Drug)&quot;, y = &quot;VO2 Max (mL/kg/min)&quot;, color = &quot;Age Category&quot;) + theme_minimal() 4.2 Interaction When we study interactions, we are trying to understand the joint effect of two or more treatments on a certain outcome. So we answer the causal question “What is the combined effect of treatment 1 and treatment 2 on an outcome?”. Simulation to Demonstrate Interaction Let’s say we are interested in understanding the effect of new drug and taking vitamin supplements on a person’s VO2 max. Assume for this example that the patients who take vitamin supplements take the same supplements in the same dosage. In this simulation, the drug increases VO2 max by 4 mL/kg/min, vitamins increase VO2 max by 1.5 mL/kg/min, and taking both the drug and vitamins adds an addition 2.5 mL/kg/min to the VO2 max. set.seed(123) n &lt;- 2000 A_1 &lt;- rbinom(n, 1, 0.5) # drug A_2 &lt;- rbinom(n, 1, 0.5) # vitamin supplementation baseline &lt;- 35 # baseline VO2 max is 35 mL/kg/min vo2_max &lt;- baseline + 4 * A_1 + 1.5 * A_2 + 2.5 * (A_1 * A_2) + rnorm(n, mean = 0, sd = 1) df &lt;- data.frame(vo2_max, A_1, A_2) naive_model &lt;- lm(vo2_max ~ A_1 + A_2, data = df) adjusted_model &lt;- lm(vo2_max ~ A_1 + A_2 + A_1 * A_2, data = df) summary(naive_model) ## ## Call: ## lm(formula = vo2_max ~ A_1 + A_2, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.4558 -0.8316 0.0082 0.7735 3.6096 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 34.41251 0.04392 783.61 &lt;2e-16 *** ## A_1 5.26868 0.05184 101.62 &lt;2e-16 *** ## A_2 2.69471 0.05184 51.98 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1.158 on 1997 degrees of freedom ## Multiple R-squared: 0.8723, Adjusted R-squared: 0.8722 ## F-statistic: 6820 on 2 and 1997 DF, p-value: &lt; 2.2e-16 summary(adjusted_model) ## ## Call: ## lm(formula = vo2_max ~ A_1 + A_2 + A_1 * A_2, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.0857 -0.6261 -0.0042 0.6543 3.3876 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 34.98227 0.04273 818.76 &lt;2e-16 *** ## A_1 4.05124 0.06246 64.87 &lt;2e-16 *** ## A_2 1.49082 0.06211 24.00 &lt;2e-16 *** ## A_1:A_2 2.43225 0.08828 27.55 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.9855 on 1996 degrees of freedom ## Multiple R-squared: 0.9075, Adjusted R-squared: 0.9073 ## F-statistic: 6526 on 3 and 1996 DF, p-value: &lt; 2.2e-16 If we look at the naive model, we would conclude that the drug increase VO2 max by 5.26 and the vitamins increase VO2 max by 2.69. But this isn’t the truth. The naive model doesn’t capture the combined effect of taking both the drug and vitamins, which is capture in the adjusted model using an interaction term. Based on the adjusted model, we would conclude that the drug increases VO2 max by 4.05, the vitamins increase VO2 max by 1.49, and taking both adds 2.43 mL/kg/min to one’s VO2 max on average. This is closer to the ground truth that we established when explaining the simulation. This plot shows that taking the drug increases VO2 max, but also taking vitamins with the drug has an combined effect that increases VO2 max. # library(ggplot2) # library(dplyr) df_grouped &lt;- df |&gt; mutate(vitamin_group = ifelse(A_2 == 1, &quot;Vitamins&quot;, &quot;No Vitamins&quot;)) ggplot(df_grouped, aes(x = A_1, y = vo2_max, color = vitamin_group)) + geom_jitter(width = 0.1, alpha = 0.4) + stat_summary(fun = mean, geom = &quot;point&quot;, size = 3, shape = 18) + stat_summary(fun = mean, geom = &quot;line&quot;, aes(group = vitamin_group)) + scale_x_continuous(breaks = c(0, 1)) + labs(title = &quot;Interaction: Drug × Vitamin Supplement&quot;, x = &quot;Treatment (0 = Control, 1 = Drug)&quot;, y = &quot;VO2 Max (mL/kg/min)&quot;, color = &quot;Vitamin Group&quot;) + theme_minimal() In this simulation, we learned that when we are interested in measuring the effect of multiple treatments on an outcome, it’s important to consider the combined effect of these treatments. We achieve this by adding an interaction term in our regression model. 4.3 Identifying Interaction Identifying interaction is crucial when studying causal relationships because it tells us whether there is a combined effect of two or more treatments on an outcome. Rather than being a source of bias like confounding, interaction reveals real differences in how subgroups respond to exposures or treatments. Detecting interaction helps researchers understand for whom and under what conditions an intervention works best, allowing for more tailored public health strategies and clinical recommendations. In our simulation with the drug and vitamin supplements, interaction was present because there was a combined effect of the drug and vitamin supplementation on VO2 max. In particular, patients that took both had the largest increases in VO2 max. By fitting a model with an interaction term between the drug and vitamin use, we were able to identify and quantify this combined interaction effect. Without testing for interaction, we would have incorrectly assumed that the drug and the vitamins independently improve VO2 max. 4.4 Effect Modification vs Interaction Effect modification and interaction are closely related concepts, but they serve slightly different purposes in causal analysis. The confusing part is when we try to model both effect modification and interaction, we do it the same way with an interaction term in the regression. However, the difference between the two concepts is in the causal questions we are trying to answer. In effect modification, we are trying to understand how the effect of a single treatment varies based on levels of another factor like age or sex assigned at birth. In interaction, we are trying to understand the combined effect of two or more treatments such as a drug and vitamin supplementation. "],["introduction-to-causal-diagrams.html", "5 Introduction to Causal Diagrams Class materials Textbook reading Supplementary reading Topics covered 5.1 Basic principles of directed acyclic graphs (DAGs) 5.2 Common Causal Structures in Public Health 5.3 Application: drawing DAGs for public health scenarios", " 5 Introduction to Causal Diagrams Class materials Slides: Module 5 Recording: Module 5, Part 1 Recording: Module 5, Part 2 Textbook reading Hernán &amp; Robins, Causal Inference: What If – Chapters 6-7 Supplementary reading Rosenbaum, P.R., &amp; Rubin, D.B. (1983). The central role of the propensity score in observational studies for causal effects. Biometrika, 70(1), 41–55. Examples from public health studies involving confounding adjustment Topics covered Basic principles of directed acyclic graphs (DAGs) Common causal structures in public health Application: drawing DAGs for public health scenarios 5.1 Basic principles of directed acyclic graphs (DAGs) Directed acyclic graphs (DAGs) are powerful tools in causal inference that visually represent assumptions about how variables are related. In a DAG, nodes represent variables, and arrows (directed edges) represent causal influences from one variable to another. DAGs are acyclic, meaning you cannot return to the same variable by following a sequence of arrows — this prevents feedback loops. These graphs also are directed, meaning that they show the ways we think the causal relationships flow from one variable to another using the arrows. The key strength of DAGs lies in their ability to clarify causal pathways, distinguish between confounding and mediation, and identify the variables we need to control for to estimate causal effects accurately. By encoding assumptions explicitly, DAGs help researchers determine whether observed associations reflect true causal relationships or are biased by omitted variables or incorrect conditioning. In our simulation, we use a DAG to represent a common public health structure involving diet, exercise, and heart health. Diet is a confounder: it directly influences both how much people exercise and their overall heart health. If we ignore diet when estimating the effect of exercise on heart health, we risk attributing diet’s effect to exercise — leading to confounding bias. The DAG for this scenario includes arrows from diet to both exercise and heart health, and from exercise to heart health. # library(ggplot2) # library(dplyr) # library(ggdag) # library(dagitty) # library(bnlearn) # library(igraph) set.seed(123) n &lt;- 2000 diet &lt;- rnorm(n) exercise &lt;- 2 * diet + rnorm(n) heart_health &lt;- 3 * exercise + 4 * diet + rnorm(n) df &lt;- data.frame(diet, exercise, heart_health) dag &lt;- model2network(&quot;[diet][exercise|diet][heart_health|diet:exercise]&quot;) g &lt;- bnlearn::as.igraph(dag) plot(g, layout = layout_as_tree(g, root = &quot;diet&quot;), vertex.label.color=&quot;black&quot;, vertex.size=60, edge.arrow.size=0.5) 5.2 Common Causal Structures in Public Health In public health research, understanding the causal relationships between variables is essential for identifying risk factors, designing interventions, and making policy decisions. Common causal structures include confounding, mediation, and colliders, each of which influences how we interpret observed associations. A confounder is a variable that affects both the exposure and the outcome, potentially biasing the estimated effect if not properly adjusted for. Assume we had a hypothesis that ice cream sales cause murder rates. We would draw the DAG below, and show that outside temperature is a confounder, since it affects both ice cream sales (the exposure) and murder rate (the outcome). A mediator lies on the causal pathway between exposure and outcome, helping to explain how the exposure exerts its effect. In the example below, weight loss is the mediator because the exposure exercise causes weight loss, which affects the risk of diabetes. Based on this DAG, we are assuming that the only way exercise affects diabetes risk is through weight loss. In reality, this might not be true, but we kept the structure of this DAG simple for example’s sake. A collider, on the other hand, is influenced by two variables, and conditioning on it can introduce spurious associations. In the example below, the lawn being wet is a collider because it is caused by both by whether the sprinkler turns on and whether it rains outside. An easy way to remember if a variable is a collider is if it is a variable where two arrows point toward (or collide into) the variable. Identifying these structures often requires drawing directed acyclic graphs (DAGs) to map out assumptions and determine which variables to adjust for when estimating causal effects. They also help us understand the flow of associations between the different variables. We use paths to track the flow of association. A backdoor path is any path from the exposure to the outcome with an arrow pointing towards the exposure. For example, in the ice cream and murder rate DAG, there is a backdoor path Ice Cream Sales \\(\\rightarrow\\) Outside Temperature \\(\\leftarrow\\) Murder Rate since the arrow between Outside Temperature and Murder Rate points back at Ice Cream Sales. Paths can either be closed or open. Opening a path allows association to flow from one variable to another, while closing does not. In general, we want to close all backdoor paths keep all other paths open by conditioning on set of specific variables. This will guarantee conditional exchangeability, allowing us to identify the causal effect. In our first simulation, we modeled a classic confounding structure, where diet influences both exercise and heart health. This mirrors real-world public health situations where health behaviors and biological outcomes are shaped by shared underlying factors like nutrition, socioeconomic status, or genetics. If we were to estimate the effect of exercise on heart health without adjusting for diet, we would risk attributing some of diet’s impact to exercise — a classic confounding problem. By visualizing the relationships using a DAG and including diet as a covariate in our regression model, we can block the backdoor path and isolate the true causal effect of exercise. This illustrates how understanding and modeling common causal structures is critical to producing valid and meaningful results in public health research. 5.3 Application: drawing DAGs for public health scenarios When modeling a relationship such as the effect of a doctor’s visit on sickness level, there are so many factors that can make a causal diagram extremely complex. In this example, there can be so many confounders such as whether the person has insurance, whether the patient was sick before, whether the person can afford to live in a clean area, whether they can take time off work to go to the doctor’s office, and so on. There appear to be too many factors that we would have to control for to identify the causal effect, but we can follow some steps to simplify and create our causal diagram. We apply steps to the examples below: List out all factors - Going to the doctor’s office, insurance status, sickness level before treatment, cleanliness of living area, available time to take off work to go to doctor’s office. Prune and combine factors based on domain knowledge - Using domain knowledge, some of the factors are related in similar ways. For example, a person’s insurance status, the quality of their living area, and whether or not they have time to take off work and go to the doctor’s all affect whether they go to the doctor’s office and their sickness level after going to the doctor’s in similar ways. Namely, the higher quality the insurance, living area, and amount of time off available, the more likely the person is going to go to a doctor’s office and be in better health on average. We can simplify these three factors into a single one such as economic status. After simplification, we now have four variables: doctor’s office visit, economic status, sickness status before visit, sickness level after visit. Add causal relationships - After simplifying our factors, we then start drawing arrows that represent the direction that causation flows from one variable to another. For example, we can hypothesize that visiting a doctor will affect a person’s sickness level, and economic status and pre-sickness level are confounders. The direction of these arrows is based on our assumptions and domain knowledge. "],["confounding-and-selection-bias.html", "6 Confounding and Selection Bias Class materials Textbook reading Supplementary reading Topics Covered 6.1 The Form of Selection Bias 6.2 How to Adjust for Selection Bias 6.3 The Structure of Confounding 6.4 How to Adjust for Confounding", " 6 Confounding and Selection Bias Class materials Slides: Module 6 Recording: Module 6, Part 1 Recording: Module 6, Part 2 Textbook reading Hernán &amp; Robins, Causal Inference: What If – Chapter 7-8 Supplementary reading Knol, M. J., &amp; VanderWeele, T. J. (2012). Recommendations for presenting analyses of effect modification and interaction. International Journal of Epidemiology, 41(2), 514–520. Real-world public health examples of effect modification Topics Covered The form of selection bias How to adjust for selection bias The structure of confounding How to adjust for confounding Critical reading exercise: sources of confounding and selection bias in public health 6.1 The Form of Selection Bias Selection bias occurs when the probability of being included in the study or analysis depends on a factor that affects the association between the treatment and the outcome. Selection bias occurs when we condition (by stratifying or controlling) on a collider or mediator. When we unintentionally condition on these causal structures, we make our estimates biased. Conditioning on a collider opens up a backdoor path, biasing our estimate. Conditioning on a mediator blocks a path that captures the effect an exposure can have on an outcome through the mediator, also biasing our estimate. In our simulation, we are interested in studying the effect of having a high income on whether a person gets regular exercise or not. We also have data on healthcare visits for each patient, which is affected both by whether they have high income and whether they exercise. For this example, assume that we do not know the true effect of income on exercise, but in reality, there is no causal effect. Since we believe there is an effect, we will show this causal relationship in our DAG. The DAG for this scenario is shown below. We introduce selection bias by adjusting on healthcare visits (a collider) in our regression. By conditioning on healthcare visits, our estimated effect will contain the association from the backdoor path. The code below estimates the effect of heart health on exercise using two models. The first model does not control for healthcare visits and unbiasedly estimates the true causal effect of 0. The second model controls for healthcare visits and suffers from selection bias. set.seed(123) n &lt;- 20000 # Income and exercise are independent (no true causal effect for this example) high_income &lt;- rbinom(n, 1, 0.4) # 40% have high income regular_exercise &lt;- rbinom(n, 1, 0.3) # 30% exercise regularly # Healthcare_visits is a collider of high_income and regular_exercise healthcare_visits &lt;- 2 + 1.5 * high_income + 1.2 * regular_exercise + rnorm(n, 0, 0.8) df &lt;- data.frame( high_income = high_income, regular_exercise = regular_exercise, healthcare_visits = healthcare_visits ) # Model 1 — No adjustment (baseline) model_unadjusted &lt;- lm(regular_exercise ~ high_income, data = df) # Model 2 — Adjusting for the collider (bad) model_adjusted_collider &lt;- lm(regular_exercise ~ high_income + healthcare_visits, data = df) # Extract coefficients coef_unadjusted &lt;- summary(model_unadjusted)$coefficients[&quot;high_income&quot;, &quot;Estimate&quot;] coef_adjusted &lt;- summary(model_adjusted_collider)$coefficients[&quot;high_income&quot;, &quot;Estimate&quot;] # Compare results cat(&quot;Coefficient without adjustment (true effect):&quot;, coef_unadjusted, &quot;\\n&quot;) ## Coefficient without adjustment (true effect): 0.004749401 cat(&quot;Coefficient with collider adjustment (biased):&quot;, coef_adjusted, &quot;\\n&quot;) ## Coefficient with collider adjustment (biased): -0.3942755 The previous scenario where we condition on a collider is more specifically known as collider bias. Had we conditioned on a mediator, this would have been mediator bias. In the example about the effect of exercise on diabetes risk, if we were to condition on weight loss when estimating our causal effect, we would block the causal path of exercise \\(\\rightarrow\\) weight loss \\(\\rightarrow\\) diabetes risk and not be able to estimate the effect of exercise on diabetes risk, mediated by weight loss. 6.2 How to Adjust for Selection Bias Adjusting for selection bias is more challenging than adjusting for confounding, because selection bias arises when the sample being analyzed is not representative of the target population due to a systematic inclusion process. This often happens when selection into the dataset depends on variables related to both the exposure and the outcome, introducing a spurious association that distorts causal estimates. Unlike confounding, which can often be handled by conditioning on measured variables, selection bias may require more complex strategies such as inverse probability weighting (IPW), sensitivity analysis, or explicitly modeling the selection mechanism. The key to adjusting for selection bias is understanding why and how certain individuals are excluded or included in the analysis — and then incorporating that information to correct the bias. 6.3 The Structure of Confounding Confounding occurs when an external variable influences both the exposure and the outcome, making it difficult to determine whether the observed association is truly causal. This third variable — the confounder — can create a misleading impression that the exposure causes the outcome, when in fact, the association may be driven entirely or partially by the confounder. The key structural feature of confounding is that the confounder must be related to both the exposure and the outcome. To obtain an accurate estimate of the exposure’s causal effect, researchers must adjust for confounding variables using methods like stratification, regression, or matching. In our simulation, age acts as a confounder because it affects both smoking behavior and lung cancer risk. Older individuals are more likely to smoke and also more likely to develop lung cancer, which can make smoking appear more harmful (or even less harmful) than it actually is if age isn’t taken into account. The naive model, which includes only smoking, produces a biased estimate because it doesn’t separate the effect of smoking from the effect of age. The adjusted model includes both smoking and age and provides a more accurate estimate of smoking’s effect by accounting for this confounding influence. This example highlights how confounding can distort findings and why controlling for related background variables is essential in observational research. For this simulation, assume smoking has a true effect of 3 on lung cancer. The DAG for this scenario is below: set.seed(123) n &lt;- 2000 age &lt;- rnorm(2000, mean = 50, sd = 10) smoking &lt;- 2 * age + rnorm(n) lung_cancer &lt;- 3 * smoking + 4 * age + rnorm(n) genetic_marker &lt;- rbinom(n, 1, prob = plogis(0.01 * smoking - 1)) df &lt;- data.frame( Age = age, Smoking = smoking, Lung_Cancer = lung_cancer, Genetic_Marker = genetic_marker ) model_naive &lt;- lm(lung_cancer ~ smoking, data = df) model_adjusted &lt;- lm(lung_cancer ~ smoking + age, data = df) coef_naive &lt;- summary(model_naive)$coefficients[&quot;smoking&quot;, &quot;Estimate&quot;] coef_adjusted &lt;- summary(model_adjusted)$coefficients[&quot;smoking&quot;, &quot;Estimate&quot;] coef_naive ## [1] 4.995915 coef_adjusted ## [1] 3.014671 Through this simulation, we learned that controlling for confounders via adjusting for them in the regression model helps prevent our estimates from being biased. Practically, in the context of public health, there will always be unobserved confounders that we can’t control for. This makes it impossible to control for all confounders. This does not mean that it is impossible to have credible causal estimates. Instead of trying to get an unbiased estimate by controlling for all confounders (which is infeasible), researchers acknowledge that unobserved confounders exist and can affect their estimates. Through a process called sensitivity analysis researchers can observe how strong a confounder has to be in order to invalidate their results. In the example above, our estimated effect after properly controlling for age is around 3. However, it is possible that we forgot to account for a genetic marker that is a confounder of smoking and lung cancer. In practice, it is infeasible to control for the genetic marker of each individual in our study, so we use sensitivity analysis to see how robust our estimates are. In the code below, we simulate how strong the association between genetic marker on smoking and the association between genetic marker and lung cancer has to be in order to invalidate our results. The heatmap shows the effect estimates for varying strengths of confounding on the exposure and outcome. Our new DAG including the genetic marker would look like the following: set.seed(123) n &lt;- 1000 age &lt;- rnorm(n) results &lt;- data.frame() a_vals &lt;- seq(0, 10, by = 1) # strength of genetic_marker on smoking b_vals &lt;- seq(0, -20, by = -1) # strength of genetic_marker on lung_cancer for (a in a_vals) { for (b in b_vals) { genetic_marker &lt;- rbinom(n, 1, 0.5) smoking_resid &lt;- a * genetic_marker + rnorm(n) smoking_resid &lt;- as.numeric(scale(smoking_resid)) # Fix variance to 1 to avoid inflating variance of smoking smoking &lt;- 4 * age + smoking_resid lung_cancer &lt;- 3 * smoking + 4 * age + b * genetic_marker + rnorm(n) df &lt;- data.frame(lung_cancer, smoking, age) model &lt;- lm(lung_cancer ~ smoking + age, data = df) est &lt;- coef(summary(model))[&quot;smoking&quot;, &quot;Estimate&quot;] se &lt;- coef(summary(model))[&quot;smoking&quot;, &quot;Std. Error&quot;] results &lt;- rbind(results, data.frame(a = a, b = b, smoking_estimate = est, se = se)) } } ggplot(results, aes(x = a, y = b, fill = smoking_estimate)) + geom_tile() + scale_fill_gradient( low = &quot;white&quot;, high = &quot;Blue&quot;, breaks = seq(3, -6, by = -1.5) ) + labs( x = &quot;Strength of Confounder on Smoking&quot;, y = &quot;Strength of Confounder on Lung Cancer&quot;, fill = &quot;Smoking Effect&quot;, title = &quot;Effect of Smoking Estimate by Confounder Strength&quot; ) + theme_minimal() + scale_y_reverse() When identifying a causal effect by assuming conditional exchangeability, sensitivity analysis is incredibly important to defending claims of causality. For example, based off this graph, one could argue that the strength of the genetic marker is likely not strong enough to change our result that smoking increases the chance of lung cancer. 6.4 How to Adjust for Confounding Adjusting for confounding is essential when estimating causal effects from observational data. Since confounders are variables that influence both the exposure and the outcome, failing to account for them can lead to biased and misleading conclusions. One of the most common ways to adjust for confounders is through multiple regression, where confounders are included as covariates in the model. Other methods include stratification, where analyses are performed within levels of the confounder, and matching, where exposed and unexposed individuals are paired based on similar values of the confounding variable. These approaches aim to isolate the effect of the exposure by holding confounders constant, thereby mimicking the balance achieved in randomized experiments. In our simulation, we demonstrated adjustment for confounding using regression. The variable age was a confounder because it influenced both smoking and lung cancer. When we fit a naive model that only included smoking, the effect estimate was biased because it reflected both smoking’s and age’s contributions to lung cancer. By including age in the model as an additional predictor, we were able to adjust for its influence. This adjustment allowed us to estimate the effect of smoking on lung cancer more accurately, as if age were held constant. This simple regression approach illustrates a key principle in observational research: if you can measure the confounder and include it in your analysis, you can often remove its biasing effect and get closer to the true causal relationship. "],["other-common-pitfalls-of-causal-analyses.html", "7 Other Common Pitfalls of Causal Analyses Class materials Textbook reading Supplementary reading Topics covered 7.1 Measurement Bias 7.2 Non-compliance 7.3 Non-Causal Diagrams 7.4 Publication Bias and P-Hacking 7.5 Over- and Mis-Interpretation of Statistical Analyses", " 7 Other Common Pitfalls of Causal Analyses Class materials Slides: Module 7 Recording: Module 7, Part 1 Recording: Module 7, Part 2 Textbook reading Hernán &amp; Robins, Causal Inference: What If – Chapter 9 Supplementary reading ADD RELEVANT READING Examples of misclassification and selection bias in public health research Topics covered Measurement bias Non-compliance Non-causal diagrams Publication bias and p-hacking Over- and mis-interpretation of statistical analyses Application: developing a checklist for critical reading of causal claims 7.1 Measurement Bias Measurement bias occurs when the method used to collect data leads to systematic errors in the values recorded for a variable. This can happen when an exposure, outcome, or confounder is misclassified or inaccurately measured in a way that consistently overstates or understates the true value. Measurement bias is problematic because it can distort observed associations and lead to incorrect conclusions about the relationships between variables. Unlike random measurement error, which tends to cancel out over large samples, measurement bias introduces consistent errors that don’t disappear with more data. It can arise from faulty instruments, poorly worded survey questions, or inconsistent data collection procedures, and it often goes unnoticed unless explicitly tested for. In public health and medical research, measurement bias can affect both exposure and outcome variables. For example, if smoking behavior is self-reported and individuals tend to underreport how much they smoke, the study will underestimate the true relationship between smoking and lung cancer. Similarly, if age is recorded in broad categories rather than precise years, it can limit the ability to adjust accurately for confounding. Even adjusting for confounders may not correct measurement bias if those confounders are also measured with error. This makes it critical to use reliable, validated measurement tools and to account for potential misclassification during analysis, especially in observational studies where data quality may vary widely. This simulation demonstrates measurement bias by comparing the estimated effect of smoking on lung cancer using the true smoking values versus mismeasured (underreported) smoking. The model using mismeasured smoking underestimates the true effect, showing how systematic error in recording an exposure can bias causal estimates toward zero. n &lt;- 2000 age &lt;- rnorm(n, mean = 50, sd = 10) true_smoking &lt;- 2 * age + rnorm(n) # no age to isolate measurement bias in smoking lung_cancer &lt;- 3 * true_smoking + rnorm(n) measured_smoking &lt;- true_smoking - rnorm(n, mean = 1, sd = 0.5) true_model &lt;- lm(lung_cancer ~ true_smoking + age) biased_model &lt;- lm(lung_cancer ~ measured_smoking + age) true_coef &lt;- summary(true_model)$coefficients[&quot;true_smoking&quot;, &quot;Estimate&quot;] biased_coef &lt;- summary(biased_model)$coefficients[&quot;measured_smoking&quot;, &quot;Estimate&quot;] true_coef ## [1] 3.008776 biased_coef ## [1] 2.445573 We can capture measurement bias in DAGs as well by denoting the measured exposure variable as \\(W^*\\). In the example below, the measured treatment \\(W^*\\) is affected both by confounders and the exposure variable \\(W\\). 7.2 Non-compliance So far we have assumed that the examples with randomized experiments that we have covered went as intended. In real experiments, sometimes participants might not comply with the treatment they are assigned to. For example, if our example is about the effect of a heart transplant on 5-year mortality, some patients might not undergo surgery even if they were assigned the surgery. To account for the potential mismatch between the treatment assigned and the treatment received for a patient in DAG notation, we use two variables. \\(Z\\) represents the assigned treatment, and \\(W\\) represents the received treatment. This is different from how we denote measurement bias because \\(Z\\) can have a causal effect on \\(Y\\). 7.3 Non-Causal Diagrams Non-causal diagrams represent associations between variables that do not imply direct cause-and-effect relationships. These diagrams are useful for illustrating statistical relationships that arise from shared causes, correlations due to bias, or measurement artifacts. In non-causal diagrams, arrows may still indicate directional influence, but they are used to reflect associations or data-generating processes, not claims about interventions. Unlike causal diagrams, which are designed to identify and estimate the effects of manipulating one variable on another, non-causal diagrams help clarify patterns in the data without asserting that changing one variable will necessarily change another. In the context of our simulation, we can use a non-causal diagram to represent the observed association between age and lung cancer without assuming a direct causal relationship. While age and lung cancer may be strongly correlated — older individuals tend to have higher cancer risk — this relationship does not imply that age causes lung cancer in an interventional sense. Instead, age may be acting as a proxy for other underlying factors like cumulative exposure to smoking or environmental risks. A non-causal diagram helps us visualize this statistical association without attributing it to a direct, manipulable pathway, highlighting that not all observed relationships in data should be interpreted as causal. 7.4 Publication Bias and P-Hacking Publication bias occurs when the likelihood of a study being published depends on the nature or direction of its results — typically favoring studies with statistically significant or “positive” findings. This creates a distorted picture of the evidence in a field, because null or contradictory results are less likely to be seen. P-hacking refers to the practice of manipulating statistical analyses or data collection until a desired (usually statistically significant) result is achieved. This can include selectively reporting outcomes, running many analyses and only publishing those with low p-values, or stopping data collection once a significant result appears. Both practices inflate false-positive rates and undermine the credibility of scientific findings. In the context of the simulation we ran — whether it involves confounding, selection bias, or measurement error — it’s easy to see how p-hacking or publication bias could skew interpretations. For example, imagine rerunning the simulation many times and only reporting the version where the naive model shows a significant effect of smoking on lung cancer (even if the underlying data or causal structure doesn’t support it). Or selectively reporting only the adjusted model that produces a “clean” result while hiding others. These practices can make even a carefully designed simulation appear misleading. The simulation reinforces the idea that statistical significance is not the same as truth, and that transparency in modeling choices and full reporting of results are critical for avoiding biased conclusions. 7.5 Over- and Mis-Interpretation of Statistical Analyses Over-interpretation occurs when researchers draw stronger conclusions from statistical results than the data can justify, while mis-interpretation involves misunderstanding what the results actually mean. A common example is interpreting a statistically significant association as proof of causation, even when the study design or model does not support that claim. Another frequent error is overstating the practical importance of a small effect size or assuming that a non-significant result means “no effect.” These issues are often driven by pressure to produce definitive conclusions, even when the data are limited, noisy, or confounded. Careful interpretation requires understanding the limits of the methods used and being transparent about uncertainty, assumptions, and alternative explanations. In the simulations we’ve conducted — such as estimating the effect of smoking on lung cancer under different types of bias — it’s easy to see how results can be over- or mis-interpreted. For instance, in a model affected by measurement bias or confounding, one might find a statistically significant association between smoking and lung cancer, but incorrectly conclude that the estimated effect size reflects the true causal effect. Alternatively, if the biased model appears significant and the true model does not, someone might misinterpret that as evidence that adjustment “eliminated” the effect, when in fact it corrected for bias. These examples highlight how even simple models can be misunderstood or overstated, and underscore the importance of grounding interpretation in study design, data limitations, and causal reasoning — not just statistical output. "],["from-identification-to-estimation.html", "8 From Identification to Estimation Class materials Textbook reading Supplementary reading Topics covered 8.1 Identification and Estimation 8.2 Estimation of causal effects 8.3 Taxonomy of estimation models", " 8 From Identification to Estimation Class materials Slides: Module 8 Recording: Module 8, Part 1 Recording: Module 8, Part 2 Textbook reading Hernán &amp; Robins, Causal Inference: What If – Chapter 10 Supplementary reading ADD RELEVANT READING Case studies on unmeasured confounding and robustness of findings Topics covered Identification versus estimation Estimation of causal effects Taxonomy of estimation models Critical reading exercise: evaluating identification and estimation in a published study 8.1 Identification and Estimation In causal inference, identification refers to the theoretical question of whether a causal effect can be determined from the observed data and the assumptions encoded in the study design or model. It answers the question: “Can we, in principle, express the causal effect of interest as a function of the observed variables?” Identification depends on assumptions such as exchangeability (no unmeasured confounding), positivity, and consistency, and often involves tools like potential outcomes or directed acyclic graphs (DAGs). If a causal effect is not identifiable, no amount of statistical analysis will yield a valid estimate — because the data alone cannot disentangle the causal effect from bias or confounding. Once identification is established, the next step is estimation, which involves applying statistical methods to calculate the size of the effect using real data. Estimation uses techniques like regression, inverse probability weighting, or matching to quantify the identified causal relationship. In our simulations, for example, once we specify that the causal effect of smoking on lung cancer is identifiable by adjusting for age, we use regression to estimate that effect. If we skip the identification step and go straight to estimation without accounting for confounding or bias, our estimates may be precise — but wrong. Together, identification and estimation form the backbone of credible causal analysis: one ensures that we’re asking the right question, and the other that we’re answering it correctly. ADD AN EXAMPLE OF GOING END-TO-END FROM CAUSAL QUESTION -&gt; IDENTIFICATION STRATEGY -&gt; DEFENDING ASSUMPTIONS –&gt; ESTIMATION 8.2 Estimation of causal effects Estimation of causal effects refers to the process of using statistical methods to quantify the size and direction of a causal relationship between an exposure and an outcome. Once a causal effect has been identified—meaning that, under certain assumptions, it can be expressed in terms of observed variables—estimation allows us to compute a numerical value for that effect using data. Common estimation techniques include linear regression, inverse probability weighting, and matching. The goal is not just to observe an association, but to measure how much changing the exposure would change the outcome, assuming the identification conditions are satisfied. 8.3 Taxonomy of estimation models The taxonomy of estimation models refers to the classification of different statistical approaches used to estimate causal effects based on the structure of the data and the assumptions made. Broadly, estimation models fall into categories such as outcome regression (e.g., linear or logistic regression), exposure modeling (e.g., propensity scores), and doubly robust methods that combine both. These models vary in how they handle confounding, missing data, and complexity of relationships between variables. Choosing the appropriate estimation model depends on the research question, the nature of the confounding, and how well the model’s assumptions align with the underlying causal structure. "],["applications-of-causal-inference-in-public-health-and-medical-research.html", "9 Applications of Causal Inference in Public Health and Medical Research Class materials Textbook reading Supplementary reading Topics covered 9.1 Public health policy evaluation 9.2 Environmental exposure studies 9.3 Health disparities research 9.4 Prevention program evaluation", " 9 Applications of Causal Inference in Public Health and Medical Research Class materials Slides: Module 9 Recording: Module 9, Part 1 Recording: Module 9, Part 2 Textbook reading Hernán &amp; Robins, Causal Inference: What If – Chapter 15 Supplementary reading Sterman, J. D. (2006). Learning from evidence in a complex world. American Journal of Public Health, 96(3), 505–514. Examples of systems-level interventions in public health and policy Topics covered Public health policy evaluation Environmental exposure studies Health disparities research Prevention program evaluation 9.1 Public health policy evaluation n &lt;- 2000 baseline_health &lt;- rnorm(n, mean = 50, sd = 10) policy &lt;- ifelse(baseline_health + rnorm(n, 0, 5) &lt; 52, 1, 0) health_outcome &lt;- 5 * policy + 0.6 * baseline_health + rnorm(n, 0, 5) df &lt;- data.frame( Policy = factor(policy, labels = c(&quot;No Policy&quot;, &quot;Policy&quot;)), Baseline_Health = baseline_health, Health_Outcome = health_outcome ) model_naive &lt;- lm(Health_Outcome ~ Policy, data = df) model_adjusted &lt;- lm(Health_Outcome ~ Policy + Baseline_Health, data = df) summary(model_naive)$coefficients[&quot;PolicyPolicy&quot;, ] ## Estimate Std. Error t value Pr(&gt;|t|) ## -3.861950e+00 2.957099e-01 -1.305993e+01 1.821710e-37 summary(model_adjusted)$coefficients[&quot;PolicyPolicy&quot;, ] ## Estimate Std. Error t value Pr(&gt;|t|) ## 5.065309e+00 3.146141e-01 1.610007e+01 6.273699e-55 library(ggplot2) ggplot(df, aes(x = Policy, y = Health_Outcome, fill = Policy)) + geom_boxplot(alpha = 0.6) + labs(title = &quot;Simulated Impact of Public Health Policy&quot;, x = &quot;Policy Implemented&quot;, y = &quot;Health Outcome After 1 Year&quot;) + theme_minimal() 9.2 Environmental exposure studies Environmental exposure studies investigate how exposure to environmental factors—such as air pollution, contaminated water, radiation, or hazardous chemicals—affects human health. These studies aim to establish causal links between environmental conditions and outcomes like respiratory illness, cancer, or developmental disorders. Because randomizing exposure is often unethical or impractical, these studies typically rely on observational data, making careful adjustment for confounders and sources of bias essential. Tools like causal diagrams, regression models, and sensitivity analyses are often employed to assess whether the observed health effects are truly caused by the environmental exposure. In the policy simulation, the setup closely resembles an environmental exposure study where “policy” could be interpreted as an intervention to reduce environmental harm (e.g., enforcing clean air regulations). The simulation demonstrated how individuals exposed to the policy had lower average health outcomes, not because the policy failed, but because those individuals started with worse baseline health. This reflects a common challenge in environmental health research: exposure is often non-random and associated with other risk factors. Just like in environmental exposure studies, it is crucial to adjust for baseline differences—such as pre-existing health or socioeconomic status—to avoid incorrectly concluding that the exposure (or policy) caused harm. 9.3 Health disparities research Health disparities research focuses on understanding and addressing differences in health outcomes across population groups defined by factors such as race, ethnicity, socioeconomic status, geography, gender, or disability. These disparities often stem from unequal access to care, systemic discrimination, environmental exposures, and social determinants of health. The goal is not only to document these differences but also to identify causal pathways and implement interventions that promote health equity. Causal inference tools are especially valuable in this field because they help distinguish between mere correlations and actual structural inequalities that can be targeted through policy and intervention. The simulation of public health policy can be directly applied to health disparities research by modeling how an intervention affects different subgroups. For instance, if a health policy is implemented in lower-income neighborhoods, those individuals might begin with worse baseline health, as shown by lower health outcomes in the policy group. Without adjusting for these baseline differences, the simulation might misleadingly suggest that the policy worsens outcomes. In reality, this reflects the importance of stratifying or adjusting for social determinants when evaluating interventions aimed at reducing disparities. The simulation thus highlights how easily misleading conclusions can arise if disparities are not properly accounted for in causal analysis. 9.4 Prevention program evaluation Prevention program evaluation involves assessing the effectiveness of initiatives designed to reduce the risk of adverse health outcomes before they occur. These programs might target behaviors (e.g., smoking cessation), environmental risks (e.g., air quality improvement), or access to services (e.g., vaccination campaigns). Evaluators aim to determine whether the program caused measurable changes in outcomes such as disease incidence, risk factor reduction, or health equity. This requires careful consideration of confounding factors, selection bias, and whether the observed differences can be attributed to the intervention itself — making causal inference tools central to prevention research. In our simulation, the public health policy acts like a prevention program aimed at improving long-term health outcomes. By comparing the health trajectories of individuals in the policy versus no-policy groups, we can estimate the effect of the intervention. However, the simulation also reveals a key challenge: even if a program targets at-risk populations, initial disparities (like poorer baseline health) may mask its true benefits unless we adjust for those differences. This mirrors real-world prevention evaluations, where randomized trials or proper covariate adjustment are essential to distinguish actual program impact from background variability. "],["presentation-of-final-projects.html", "10 Presentation of Final Projects Class materials Guidelines 10.1 Final Project", " 10 Presentation of Final Projects Class materials Slides: Final Project Overview Recording: Project Presentation Session Guidelines Presentation of Final Projects Review of group projects 10.1 Final Project The final project is a group-based assignment designed to assess your ability to critically evaluate causal claims in real-world public health or epidemiological research. Working in teams of 3–4, you will select a published study and analyze it through the lens of causal inference. This includes clearly identifying the causal question the authors are attempting to answer, articulating the assumptions underlying their analysis, and evaluating whether the study’s design supports a valid causal interpretation. You’ll be expected to consider the use of tools like directed acyclic graphs (DAGs), potential confounders, selection bias, and whether the identification strategy is sound. In addition to identifying strengths and weaknesses in the study, your team will propose potential improvements or alternative approaches that could enhance causal validity. This might involve suggesting better adjustment strategies, different data collection designs, or more transparent modeling techniques. Ultimately, your goal is to interpret the study’s findings not just statistically, but causally — and explain their relevance for real-world public health policy or interventions. Your work will culminate in a 10-minute group presentation during Week 10 and a 3–4 page written report submitted during finals week, both of which demonstrate your ability to apply course concepts to actual scientific literature. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
